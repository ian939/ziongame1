<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ³ ê¼¬ë§ˆ ìš”ë¦¬ì‚¬ì˜ ë§›ìˆëŠ” ë ˆìŠ¤í† ë‘</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Jua', sans-serif; /* ê·€ì—¬ìš´ í°íŠ¸ ì ìš© */
            background-color: #fdf6e3; /* ë”°ëœ»í•œ ë°°ê²½ìƒ‰ */
            overflow-x: hidden;
        }
        
        /* ê·€ì—¬ìš´ ê·¸ë¦¼ì íš¨ê³¼ */
        .cute-shadow {
            box-shadow: 0 4px 0 rgba(0,0,0,0.1), 0 8px 20px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
        }
        
        .cute-shadow:active {
            box-shadow: 0 2px 0 rgba(0,0,0,0.1);
            transform: translateY(2px);
        }

        /* í†µí†µ íŠ€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes bounce-gentle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce-gentle {
            animation: bounce-gentle 2s infinite;
        }
        
        /* í´ë¦­ ê°€ëŠ¥í•œ ìš”ì†Œ ì»¤ì„œ ë³€ê²½ */
        .clickable {
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—°ê²°
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion; // CDNì—ì„œëŠ” window.Motionìœ¼ë¡œ ì ‘ê·¼

        // ğŸ”Š ì‚¬ìš´ë“œ íš¨ê³¼ ì‹œìŠ¤í…œ
        const SoundSystem = {
            audioContext: null,
            
            // AudioContext ì´ˆê¸°í™” (ë¸Œë¼ìš°ì € ì •ì±…ìƒ ì‚¬ìš©ì ì¸í„°ë™ì…˜ í›„ ì´ˆê¸°í™” í•„ìš”)
            init() {
                if (!this.audioContext) {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                if (this.audioContext.state === 'suspended') {
                    this.audioContext.resume();
                }
            },
            
            // ì¬ë£Œ ë‹´ê¸° ì†Œë¦¬ (ë˜‘!)
            playPop() {
                this.init();
                const ctx = this.audioContext;
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.1);
            },
            
            // ìš”ë¦¬ ì™„ì„± ì†Œë¦¬ (ë ë§~)
            playSuccess() {
                this.init();
                const ctx = this.audioContext;
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                oscillator.frequency.setValueAtTime(523.25, ctx.currentTime); // C5
                oscillator.frequency.setValueAtTime(659.25, ctx.currentTime + 0.1); // E5
                oscillator.frequency.setValueAtTime(783.99, ctx.currentTime + 0.2); // G5
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.4);
            },
            
            // ëƒ ëƒ  ì†Œë¦¬ (ë™ë¬¼ì´ ë¨¹ëŠ” ì†Œë¦¬)
            playEating() {
                this.init();
                const ctx = this.audioContext;
                
                // ëƒ ëƒ  ì†Œë¦¬ (3ë²ˆ ë°˜ë³µ)
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const oscillator = ctx.createOscillator();
                        const gainNode = ctx.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(ctx.destination);
                        
                        oscillator.frequency.value = 300 + Math.random() * 200;
                        oscillator.type = 'square';
                        
                        gainNode.gain.setValueAtTime(0.15, ctx.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
                        
                        oscillator.start(ctx.currentTime);
                        oscillator.stop(ctx.currentTime + 0.15);
                    }, i * 300);
                }
            },
            
            // ë™ì „ ì†Œë¦¬
            playCoin() {
                this.init();
                const ctx = this.audioContext;
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                oscillator.frequency.setValueAtTime(1000, ctx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1500, ctx.currentTime + 0.1);
                oscillator.type = 'triangle';
                
                gainNode.gain.setValueAtTime(0.2, ctx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.2);
            },
            
            // ì‹¤íŒ¨ ì†Œë¦¬ (ì–´ë¨¸ë‚˜...)
            playFail() {
                this.init();
                const ctx = this.audioContext;
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                oscillator.frequency.setValueAtTime(400, ctx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(200, ctx.currentTime + 0.3);
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0.2, ctx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
                
                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.3);
            },
            
            // ë ˆë²¨ì—… ì†Œë¦¬ (íŒ¡íŒŒë ˆ)
            playLevelUp() {
                this.init();
                const ctx = this.audioContext;
                const notes = [523.25, 587.33, 659.25, 783.99]; // C-D-E-G
                
                notes.forEach((freq, i) => {
                    setTimeout(() => {
                        const oscillator = ctx.createOscillator();
                        const gainNode = ctx.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(ctx.destination);
                        
                        oscillator.frequency.value = freq;
                        oscillator.type = 'sine';
                        
                        gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
                        
                        oscillator.start(ctx.currentTime);
                        oscillator.stop(ctx.currentTime + 0.3);
                    }, i * 150);
                });
            }
        };

        // í•œê¸€ ì¡°ì‚¬ ìë™ ì²˜ë¦¬ í—¬í¼ í•¨ìˆ˜
        function getJosa(name, josa) {
            const lastChar = name.charAt(name.length - 1);
            const code = lastChar.charCodeAt(0) - 0xAC00;
            const hasFinalConsonant = code % 28 !== 0;
            
            if (josa === 'ì´/ê°€') {
                return hasFinalConsonant ? 'ì´' : 'ê°€';
            } else if (josa === 'ì„/ë¥¼') {
                return hasFinalConsonant ? 'ì„' : 'ë¥¼';
            } else if (josa === 'ì€/ëŠ”') {
                return hasFinalConsonant ? 'ì€' : 'ëŠ”';
            }
            return '';
        }

        // ê²Œì„ ë°ì´í„°
const GAME_DATA = {
    // ì¬ë£Œ ë°ì´í„°
    ingredients: {
        // ìˆ˜ìŠµìš”ë¦¬ì‚¬ ì¬ë£Œ (Level 1)
        apple: { id: 'apple', name: 'ì‚¬ê³¼', emoji: 'ğŸ', category: 'fruit', level: 1 },
        banana: { id: 'banana', name: 'ë°”ë‚˜ë‚˜', emoji: 'ğŸŒ', category: 'fruit', level: 1 },
        carrot: { id: 'carrot', name: 'ë‹¹ê·¼', emoji: 'ğŸ¥•', category: 'vegetable', level: 1 },
        tomato: { id: 'tomato', name: 'í† ë§ˆí† ', emoji: 'ğŸ…', category: 'vegetable', level: 1 },
        onion: { id: 'onion', name: 'ì–‘íŒŒ', emoji: 'ğŸ§…', category: 'vegetable', level: 1 },
        potato: { id: 'potato', name: 'ê°ì', emoji: 'ğŸ¥”', category: 'vegetable', level: 1 },
        milk: { id: 'milk', name: 'ìš°ìœ ', emoji: 'ğŸ¥›', category: 'dairy', level: 1 },
        egg: { id: 'egg', name: 'ê³„ë€', emoji: 'ğŸ¥š', category: 'protein', level: 1 },
        cheese: { id: 'cheese', name: 'ì¹˜ì¦ˆ', emoji: 'ğŸ§€', category: 'dairy', level: 1 },
        bread: { id: 'bread', name: 'ë¹µ', emoji: 'ğŸ', category: 'grain', level: 1 },
        // [NEW] ë”¸ê¸°, ì´ˆì½œë¦¿ ì¶”ê°€
        strawberry: { id: 'strawberry', name: 'ë”¸ê¸°', emoji: 'ğŸ“', category: 'fruit', level: 1 },
        chocolate: { id: 'chocolate', name: 'ì´ˆì½œë¦¿', emoji: 'ğŸ«', category: 'sweets', level: 1 },

        // ìš”ë¦¬ì‚¬ ì¶”ê°€ ì¬ë£Œ (Level 2)
        cucumber: { id: 'cucumber', name: 'ì˜¤ì´', emoji: 'ğŸ¥’', category: 'vegetable', level: 2 },
        mushroom: { id: 'mushroom', name: 'ë²„ì„¯', emoji: 'ğŸ„', category: 'vegetable', level: 2 },
        bacon: { id: 'bacon', name: 'ë² ì´ì»¨', emoji: 'ğŸ¥“', category: 'protein', level: 2 },
        rice: { id: 'rice', name: 'ìŒ€', emoji: 'ğŸš', category: 'grain', level: 2 },
        noodle: { id: 'noodle', name: 'ë©´', emoji: 'ğŸœ', category: 'grain', level: 2 },
        // [NEW] ë‹­ê³ ê¸°, ìƒì¶” ì¶”ê°€
        chicken: { id: 'chicken', name: 'ë‹­ê³ ê¸°', emoji: 'ğŸ—', category: 'protein', level: 2 },
        lettuce: { id: 'lettuce', name: 'ìƒì¶”', emoji: 'ğŸ¥¬', category: 'vegetable', level: 2 },

        // ì „ë¬¸ìš”ë¦¬ì‚¬ ì¶”ê°€ ì¬ë£Œ (Level 3)
        broccoli: { id: 'broccoli', name: 'ë¸Œë¡œì½œë¦¬', emoji: 'ğŸ¥¦', category: 'vegetable', level: 3 },
        corn: { id: 'corn', name: 'ì˜¥ìˆ˜ìˆ˜', emoji: 'ğŸŒ½', category: 'vegetable', level: 3 },
        pumpkin: { id: 'pumpkin', name: 'í˜¸ë°•', emoji: 'ğŸƒ', category: 'vegetable', level: 3 },
        pepper: { id: 'pepper', name: 'í”¼ë§', emoji: 'ğŸ«‘', category: 'vegetable', level: 3 },
        fish: { id: 'fish', name: 'ìƒì„ ', emoji: 'ğŸŸ', category: 'protein', level: 3 },
        shrimp: { id: 'shrimp', name: 'ìƒˆìš°', emoji: 'ğŸ¦', category: 'protein', level: 3 },
        // [NEW] ì†Œê³ ê¸°, ë§ˆëŠ˜ ì¶”ê°€
        beef: { id: 'beef', name: 'ì†Œê³ ê¸°', emoji: 'ğŸ¥©', category: 'protein', level: 3 },
        garlic: { id: 'garlic', name: 'ë§ˆëŠ˜', emoji: 'ğŸ§„', category: 'vegetable', level: 3 },
    },
    
    // ìš”ë¦¬ ë©”ë‰´
    recipes: {
        // --- ìˆ˜ìŠµìš”ë¦¬ì‚¬ ìš”ë¦¬ (Level 1) ---
        tomatoSoup: {
            id: 'tomatoSoup',
            name: 'í† ë§ˆí†  ìˆ˜í”„',
            emoji: 'ğŸ²',
            price: 500,
            ingredients: ['tomato', 'tomato', 'onion'],
            cookingTool: 'pot',
            description: 'ë¹¨ê°„ í† ë§ˆí† ë¡œ ë§Œë“  ë”°ëœ»í•œ ìˆ˜í”„',
            level: 1
        },
        friedEgg: {
            id: 'friedEgg',
            name: 'ê³„ë€ í›„ë¼ì´',
            emoji: 'ğŸ³',
            price: 300,
            ingredients: ['egg', 'egg'],
            cookingTool: 'pan',
            description: 'ë…¸ë¦‡ë…¸ë¦‡ ê³„ë€ í›„ë¼ì´',
            level: 1
        },
        carrotSalad: {
            id: 'carrotSalad',
            name: 'ë‹¹ê·¼ ìƒëŸ¬ë“œ',
            emoji: 'ğŸ¥—',
            price: 400,
            ingredients: ['carrot', 'carrot', 'tomato'],
            cookingTool: 'bowl',
            description: 'ì‹ ì„ í•œ ì±„ì†Œ ìƒëŸ¬ë“œ',
            level: 1
        },
        cheeseSandwich: {
            id: 'cheeseSandwich',
            name: 'ì¹˜ì¦ˆ ìƒŒë“œìœ„ì¹˜',
            emoji: 'ğŸ¥ª',
            price: 600,
            ingredients: ['bread', 'cheese', 'tomato'],
            cookingTool: 'pan',
            description: 'ê³ ì†Œí•œ ì¹˜ì¦ˆ ìƒŒë“œìœ„ì¹˜',
            level: 1
        },
        applePie: {
            id: 'applePie',
            name: 'ì‚¬ê³¼ íŒŒì´',
            emoji: 'ğŸ¥§',
            price: 700,
            ingredients: ['apple', 'apple', 'apple'],
            cookingTool: 'pot',
            description: 'ë‹¬ì½¤í•œ ì‚¬ê³¼ íŒŒì´',
            level: 1
        },
        // [NEW] ë”¸ê¸° ì£¼ìŠ¤ (Level 1)
        strawberryJuice: {
            id: 'strawberryJuice',
            name: 'ë”¸ê¸° ì£¼ìŠ¤',
            emoji: 'ğŸ¥¤',
            price: 500,
            ingredients: ['strawberry', 'strawberry', 'milk'],
            cookingTool: 'bowl',
            description: 'ìƒí¼í•˜ê³  ë‹¬ì½¤í•œ ë¦¬ì–¼ ë”¸ê¸° ì£¼ìŠ¤',
            level: 1
        },

        // --- ìš”ë¦¬ì‚¬ ìš”ë¦¬ (Level 2) ---
        mushroomSoup: {
            id: 'mushroomSoup',
            name: 'ë²„ì„¯ í¬ë¦¼ ìˆ˜í”„',
            emoji: 'ğŸ„',
            price: 800,
            ingredients: ['mushroom', 'mushroom', 'milk', 'onion'],
            cookingTool: 'pot',
            description: 'ë¶€ë“œëŸ¬ìš´ ë²„ì„¯ í¬ë¦¼ ìˆ˜í”„',
            level: 2
        },
        baconEggToast: {
            id: 'baconEggToast',
            name: 'ë² ì´ì»¨ ì—ê·¸ í† ìŠ¤íŠ¸',
            emoji: 'ğŸ',
            price: 900,
            ingredients: ['bread', 'bacon', 'egg', 'cheese'],
            cookingTool: 'pan',
            description: 'ë“ ë“ í•œ ë² ì´ì»¨ ì—ê·¸ í† ìŠ¤íŠ¸',
            level: 2
        },
        friedRice: {
            id: 'friedRice',
            name: 'ë³¶ìŒë°¥',
            emoji: 'ğŸ³',
            price: 700,
            ingredients: ['rice', 'egg', 'carrot', 'onion'],
            cookingTool: 'pan',
            description: 'ë§›ìˆëŠ” ë³¶ìŒë°¥',
            level: 2
        },
        vegetableNoodle: {
            id: 'vegetableNoodle',
            name: 'ì•¼ì±„ ë¼ë©´',
            emoji: 'ğŸœ',
            price: 600,
            ingredients: ['noodle', 'cucumber', 'carrot', 'egg'],
            cookingTool: 'pot',
            description: 'ê±´ê°•í•œ ì•¼ì±„ ë¼ë©´',
            level: 2
        },
        potatoSalad: {
            id: 'potatoSalad',
            name: 'ê°ì ìƒëŸ¬ë“œ',
            emoji: 'ğŸ¥”',
            price: 500,
            ingredients: ['potato', 'egg', 'cucumber', 'carrot'],
            cookingTool: 'bowl',
            description: 'ê³ ì†Œí•œ ê°ì ìƒëŸ¬ë“œ',
            level: 2
        },
        // [NEW] ì¹˜í‚¨ ìƒëŸ¬ë“œ (Level 2)
        chickenSalad: {
            id: 'chickenSalad',
            name: 'ì¹˜í‚¨ ìƒëŸ¬ë“œ',
            emoji: 'ğŸ¥—',
            price: 800,
            ingredients: ['chicken', 'lettuce', 'tomato', 'cucumber'],
            cookingTool: 'bowl',
            description: 'ê±´ê°•í•˜ê³  ë“ ë“ í•œ ë‹­ê°€ìŠ´ì‚´ ìƒëŸ¬ë“œ',
            level: 2
        },
        // [NEW] ì´ˆì½” ì¼€ì´í¬ (Level 2)
        chocolateCake: {
            id: 'chocolateCake',
            name: 'ì´ˆì½” ì¼€ì´í¬',
            emoji: 'ğŸ‚',
            price: 900,
            ingredients: ['bread', 'chocolate', 'egg', 'milk'],
            cookingTool: 'pan',
            description: 'ë‹¬ì½¤í•œ ì´ˆì½œë¦¿ì´ ê°€ë“í•œ ì¼€ì´í¬',
            level: 2
        },

        // --- ì „ë¬¸ìš”ë¦¬ì‚¬ ìš”ë¦¬ (Level 3) ---
        seafoodPasta: {
            id: 'seafoodPasta',
            name: 'í•´ì‚°ë¬¼ íŒŒìŠ¤íƒ€',
            emoji: 'ğŸ',
            price: 1200,
            ingredients: ['noodle', 'shrimp', 'fish', 'tomato', 'onion'],
            cookingTool: 'pan',
            description: 'í’ì„±í•œ í•´ì‚°ë¬¼ íŒŒìŠ¤íƒ€',
            level: 3
        },
        grilledFish: {
            id: 'grilledFish',
            name: 'ìƒì„  êµ¬ì´',
            emoji: 'ğŸŸ',
            price: 1000,
            ingredients: ['fish', 'fish', 'pepper', 'broccoli'],
            cookingTool: 'pan',
            description: 'ì‹ ì„ í•œ ìƒì„  êµ¬ì´',
            level: 3
        },
        cornSoup: {
            id: 'cornSoup',
            name: 'ì˜¥ìˆ˜ìˆ˜ í¬ë¦¼ ìˆ˜í”„',
            emoji: 'ğŸŒ½',
            price: 900,
            ingredients: ['corn', 'corn', 'milk', 'potato'],
            cookingTool: 'pot',
            description: 'ë‹¬ì½¤í•œ ì˜¥ìˆ˜ìˆ˜ ìˆ˜í”„',
            level: 3
        },
        pumpkinRisotto: {
            id: 'pumpkinRisotto',
            name: 'í˜¸ë°• ë¦¬ì¡°ë˜',
            emoji: 'ğŸƒ',
            price: 1100,
            ingredients: ['rice', 'pumpkin', 'cheese', 'mushroom', 'onion'],
            cookingTool: 'pot',
            description: 'ë¶€ë“œëŸ¬ìš´ í˜¸ë°• ë¦¬ì¡°ë˜',
            level: 3
        },
        shrimpSalad: {
            id: 'shrimpSalad',
            name: 'ìƒˆìš° ìƒëŸ¬ë“œ',
            emoji: 'ğŸ¦',
            price: 800,
            ingredients: ['shrimp', 'broccoli', 'corn', 'tomato'],
            cookingTool: 'bowl',
            description: 'ì‹ ì„ í•œ ìƒˆìš° ìƒëŸ¬ë“œ',
            level: 3
        },
        vegetableStew: {
            id: 'vegetableStew',
            name: 'ì•¼ì±„ ìŠ¤íŠœ',
            emoji: 'ğŸ¥˜',
            price: 1000,
            ingredients: ['potato', 'carrot', 'broccoli', 'pumpkin', 'onion'],
            cookingTool: 'pot',
            description: 'í‘¸ì§í•œ ì•¼ì±„ ìŠ¤íŠœ',
            level: 3
        },
        // [NEW] ë§ˆëŠ˜ ìŠ¤í…Œì´í¬ (Level 3)
        garlicSteak: {
            id: 'garlicSteak',
            name: 'ë§ˆëŠ˜ ìŠ¤í…Œì´í¬',
            emoji: 'ğŸ¥©',
            price: 1500,
            ingredients: ['beef', 'garlic', 'mushroom', 'pepper', 'onion'],
            cookingTool: 'pan',
            description: 'ë§ˆëŠ˜ í–¥ì´ ê°€ë“í•œ ìµœê³ ê¸‰ ì†Œê³ ê¸° ìŠ¤í…Œì´í¬',
            level: 3
        },
        // [NEW] ì¹˜ì¦ˆ í–„ë²„ê±° (Level 3)
        hamburger: {
            id: 'hamburger',
            name: 'ì¹˜ì¦ˆ í–„ë²„ê±°',
            emoji: 'ğŸ”',
            price: 1300,
            ingredients: ['bread', 'beef', 'cheese', 'lettuce', 'tomato'],
            cookingTool: 'pan',
            description: 'íŒ¨í‹°ì™€ ì•¼ì±„ê°€ ë“¬ë¿ ë“¤ì–´ê°„ ìˆ˜ì œ ë²„ê±°',
            level: 3
        },
        // ì§€ì˜¨ì´ì˜ ìŠ¤í˜ì…œ ìš”ë¦¬ (ì„¤ê¸° ì „ìš©)
        jionSpecial: {
            id: 'jionSpecial',
            name: 'ì§€ì˜¨ì´ì˜ ìŠ¤í˜ì…œ ìš”ë¦¬',
            emoji: 'ğŸŒŸ',
            price: 2000,
            ingredients: ['shrimp', 'fish', 'bacon', 'cheese', 'broccoli', 'corn', 'mushroom', 'tomato'],
            cookingTool: 'pan',
            description: 'ìµœê³ ê¸‰ ì¬ë£Œë¡œ ë§Œë“  íŠ¹ë³„í•œ ìš”ë¦¬',
            level: 3,
            special: true
        },
        // [ì¶”ê°€] ì¹œêµ¬ë“¤ì„ ìœ„í•œ ììœ  ë ˆì‹œí”¼ (recipes ì•ˆì— ìˆì–´ì•¼ í•¨!)
        freestyle: {
            id: 'freestyle',
            name: 'ì¹œêµ¬ë¥¼ ìœ„í•œ íŠ¹ë³„ ìš”ë¦¬',
            emoji: 'ğŸ',
            price: 0,
            ingredients: [],
            cookingTool: 'any',
            description: 'ì¹œêµ¬ê°€ ì¢‹ì•„í•˜ëŠ” ì¬ë£Œë¥¼ ë“¬ë¿ ë„£ì–´ì£¼ì„¸ìš”!',
            level: 1,
            isFreestyle: true
        }
    }, // recipes ë

    // ë™ë¬¼ ì†ë‹˜
    animals: [
        { id: 'dog', emoji: 'ğŸ¶', name: 'ê°•ì•„ì§€', color: '#FFD700' },
        { id: 'cat', emoji: 'ğŸ±', name: 'ê³ ì–‘ì´', color: '#FFB6C1' },
        { id: 'bear', emoji: 'ğŸ»', name: 'ê³°ëŒì´', color: '#DEB887' },
        { id: 'rabbit', emoji: 'ğŸ°', name: 'í† ë¼', color: '#E6E6FA' },
        { id: 'fox', emoji: 'ğŸ¦Š', name: 'ì—¬ìš°', color: '#FF8C69' },
        { id: 'panda', emoji: 'ğŸ¼', name: 'íŒë‹¤', color: '#F0F0F0' },
        { id: 'penguin', emoji: 'ğŸ§', name: 'í­ê·„', color: '#B0E0E6' },
        // [NEW] ìƒˆë¡œìš´ ë™ë¬¼ ì†ë‹˜ 5ë§ˆë¦¬
        { id: 'tiger', emoji: 'ğŸ¯', name: 'í˜¸ë‘ì´', color: '#FFA500' },
        { id: 'lion', emoji: 'ğŸ¦', name: 'ì‚¬ì', color: '#F4A460' },
        { id: 'koala', emoji: 'ğŸ¨', name: 'ì½”ì•Œë¼', color: '#D3D3D3' },
        { id: 'frog', emoji: 'ğŸ¸', name: 'ê°œêµ¬ë¦¬', color: '#98FB98' },
        { id: 'chick', emoji: 'ğŸ¥', name: 'ë³‘ì•„ë¦¬', color: '#FFFFE0' },
        
        { id: 'corgi', emoji: 'ğŸ•', name: 'ì„¤ê¸°', color: '#FFE4B5', special: 'jion' }, // ì›°ì‹œì½”ê¸° - ì§€ì˜¨ì´ì˜ ìŠ¤í˜ì…œ ìš”ë¦¬ ì£¼ë¬¸
        // ê³¤ì¶© ì†ë‹˜ (Level 3)
        { id: 'beetle', emoji: 'ğŸª²', name: 'ì¥ìˆ˜í’ë…ì´', color: '#8B4513' },
        { id: 'wasp', emoji: 'ğŸ', name: 'ì¥ìˆ˜ë§ë²Œ', color: '#FFD700' },
        { id: 'mantis', emoji: 'ğŸ¦—', name: 'ì‚¬ë§ˆê·€', color: '#90EE90' },
        { id: 'dragonfly', emoji: 'ğŸ¦Ÿ', name: 'ì ìë¦¬', color: '#87CEEB' },
        // [ì¶”ê°€] ì•„ë“¤ì˜ ì¹œêµ¬ë“¤
        { id: 'junsu', emoji: 'ğŸ‘¦', name: 'ì¤€ìˆ˜', color: '#A3D8FF', type: 'friend', desc: 'ë§ë²Œ ë°•ì‚¬' },
        { id: 'minjun', emoji: 'ğŸ§‘', name: 'ë¯¼ì¤€', color: '#C3FFD8', type: 'friend', desc: 'ê³¼í•™ ëŒ€ì¥' },
        { id: 'taehee', emoji: 'ğŸ‘§', name: 'íƒœí¬', color: '#FFC3C3', type: 'friend', desc: 'ë³´ë“œê²Œì„ ê³µì£¼' },
    ],
    
    // í™”í (ê±°ìŠ¤ë¦„ëˆìš©)
    money: [
        { value: 1000, emoji: 'ğŸ’µ', name: 'ì²œì›' },
        { value: 500, emoji: 'ğŸ’´', name: 'ì˜¤ë°±ì›' },
        { value: 100, emoji: 'ğŸª™', name: 'ë°±ì›' },
    ]
};
        // ì¡°ë¦¬ ë„êµ¬ ì •ë³´
        const COOKING_TOOLS = {
            pot: { name: 'ëƒ„ë¹„', emoji: 'ğŸ²', color: 'bg-red-100' },
            pan: { name: 'í›„ë¼ì´íŒ¬', emoji: 'ğŸ³', color: 'bg-yellow-100' },
            bowl: { name: 'ê·¸ë¦‡', emoji: 'ğŸ¥—', color: 'bg-green-100' }
        };

        // ë©”ì¸ ê²Œì„ ì»´í¬ë„ŒíŠ¸
        function RestaurantGame() {
            const [gameStage, setGameStage] = useState('welcome'); 
            // welcome, order, recipe, cooking, serving, payment, result
            
            const [level, setLevel] = useState(1);
            const [currentAnimal, setCurrentAnimal] = useState(null);
            const [currentRecipe, setCurrentRecipe] = useState(null);
            const [currentOrders, setCurrentOrders] = useState([]); // ìš”ë¦¬ì‚¬ì—ì„œ 2ê°œ ì£¼ë¬¸
            const [completedOrders, setCompletedOrders] = useState([]); // ì™„ì„±í•œ ìš”ë¦¬ ëª©ë¡
            const [currentOrderIndex, setCurrentOrderIndex] = useState(0); // í˜„ì¬ ë§Œë“¤ê³  ìˆëŠ” ìš”ë¦¬ ì¸ë±ìŠ¤
            const [cookingPot, setCookingPot] = useState([]); // ì¡°ë¦¬ ë„êµ¬ì— ë‹´ê¸´ ì¬ë£Œ
            const [customerPayment, setCustomerPayment] = useState(0); // ì†ë‹˜ì´ ë‚¸ ëˆ
            const [selectedChange, setSelectedChange] = useState([]); // ì„ íƒí•œ ê±°ìŠ¤ë¦„ëˆ
            const [showFeedback, setShowFeedback] = useState(false);
            const [feedbackMessage, setFeedbackMessage] = useState('');
            const [score, setScore] = useState(1000); // ì‹œì‘ ê¸ˆì•¡ 1000ì›
            const [failedDish, setFailedDish] = useState(null); // ì‹¤íŒ¨í•œ ìš”ë¦¬ ì •ë³´
            
            // ê²Œì„ ë°ì´í„° ë¡œë“œ (í˜ì´ì§€ ë¡œë“œ ì‹œ)
            useEffect(() => {
                const savedData = localStorage.getItem('restaurantGameState');
                if (savedData) {
                    try {
                        const data = JSON.parse(savedData);
                        // welcome í™”ë©´ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ë³µì›
                        if (data.gameStage && data.gameStage !== 'welcome') {
                            setGameStage(data.gameStage);
                            setLevel(data.level || 1);
                            setScore(data.score || 1000);
                            setCurrentAnimal(data.currentAnimal || null);
                            setCurrentRecipe(data.currentRecipe || null);
                            setCurrentOrders(data.currentOrders || []);
                            setCompletedOrders(data.completedOrders || []);
                            setCurrentOrderIndex(data.currentOrderIndex || 0);
                            setCookingPot(data.cookingPot || []);
                            setCustomerPayment(data.customerPayment || 0);
                            setSelectedChange(data.selectedChange || []);
                            setFailedDish(data.failedDish || null);
                            console.log('ê²Œì„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ!', data);
                        }
                    } catch (error) {
                        console.error('ì €ì¥ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
                    }
                }
            }, []);
            
            // ê²Œì„ ë°ì´í„° ìë™ ì €ì¥ (ìƒíƒœ ë³€ê²½ ì‹œ)
            useEffect(() => {
                if (gameStage !== 'welcome') {
                    const saveData = {
                        gameStage,
                        level,
                        score,
                        currentAnimal,
                        currentRecipe,
                        currentOrders,
                        completedOrders,
                        currentOrderIndex,
                        cookingPot,
                        customerPayment,
                        selectedChange,
                        failedDish,
                        savedAt: new Date().toISOString()
                    };
                    localStorage.setItem('restaurantGameState', JSON.stringify(saveData));
                }
            }, [gameStage, level, score, currentAnimal, currentRecipe, currentOrders, completedOrders, currentOrderIndex, cookingPot, customerPayment, selectedChange, failedDish]);
            
            // ê²Œì„ ì‹œì‘
            const startGame = (startLevel = 1) => {
                setLevel(startLevel);
                generateOrder();
                setGameStage('order');
                // ì‹œì‘ ê¸ˆì•¡ ì„¤ì •
                if (startLevel === 4) {
                    setScore(50000); // ì „ë¬¸ê²½ì˜ì¸ì€ 50,000ì›ë¶€í„°
                } else if (startLevel === 3) {
                    setScore(10000); // ì „ë¬¸ìš”ë¦¬ì‚¬ëŠ” 10,000ì›ë¶€í„°
                } else if (startLevel === 2) {
                    setScore(3000); // ìš”ë¦¬ì‚¬ëŠ” 3,000ì›ë¶€í„°
                } else {
                    setScore(1000); // ìˆ˜ìŠµìš”ë¦¬ì‚¬ëŠ” 1,000ì›ë¶€í„°
                }
            };
            
// [ìˆ˜ì •ë¨] ì£¼ë¬¸ ìƒì„± (Level 4ëŠ” ëª¨ë“  ìš”ë¦¬ ë“±ì¥)
            const generateOrder = () => {
                // ì¹œêµ¬ê°€ ì˜¬ í™•ë¥  30%, ë™ë¬¼ì´ ì˜¬ í™•ë¥  70%
                const isFriendVisitor = Math.random() < 0.3; 
                
                let randomCustomer;
                
                if (isFriendVisitor) {
                    // --- ì¹œêµ¬ ì†ë‹˜ (ììœ  ìš”ë¦¬) ---
                    const friends = GAME_DATA.animals.filter(a => a.type === 'friend');
                    randomCustomer = friends[Math.floor(Math.random() * friends.length)];
                    
                    const specialRecipe = GAME_DATA.recipes.freestyle;
                    
                    setCurrentAnimal(randomCustomer);
                    setCurrentRecipe(specialRecipe);
                    setCurrentOrders([specialRecipe]);
                    
                } else {
                    // --- ë™ë¬¼ ì†ë‹˜ (ì¼ë°˜ ìš”ë¦¬) ---
                    const animals = GAME_DATA.animals.filter(a => a.type !== 'friend');
                    randomCustomer = animals[Math.floor(Math.random() * animals.length)];
                    
                    if (level === 1) {
                        // Level 1: 1ë‹¨ê³„ ìš”ë¦¬ 1ê°œ
                        const level1Recipes = Object.values(GAME_DATA.recipes).filter(r => r.level === 1 && !r.isFreestyle);
                        const randomRecipe = level1Recipes[Math.floor(Math.random() * level1Recipes.length)];
                        setCurrentAnimal(randomCustomer);
                        setCurrentRecipe(randomRecipe);
                        setCurrentOrders([randomRecipe]);

                    } else if (level === 2) {
                        // Level 2: 2ë‹¨ê³„ ìš”ë¦¬ 2ê°œ
                        const level2Recipes = Object.values(GAME_DATA.recipes).filter(r => r.level === 2 && !r.isFreestyle);
                        const recipe1 = level2Recipes[Math.floor(Math.random() * level2Recipes.length)];
                        let recipe2 = level2Recipes[Math.floor(Math.random() * level2Recipes.length)];
                        
                        // ì¤‘ë³µ ë°©ì§€ (ê°€ëŠ¥í•˜ë‹¤ë©´)
                        if (level2Recipes.length > 1) {
                            while (recipe2.id === recipe1.id) {
                                recipe2 = level2Recipes[Math.floor(Math.random() * level2Recipes.length)];
                            }
                        }
                        
                        setCurrentAnimal(randomCustomer);
                        setCurrentRecipe(recipe1);
                        setCurrentOrders([recipe1, recipe2]);

                    } else {
                        // Level 3 ì´ìƒ (3ê°œ ì£¼ë¬¸)
                        
                        // ì„¤ê¸°(ì½”ê¸°)ëŠ” ë¬´ì¡°ê±´ ìŠ¤í˜ì…œ ìš”ë¦¬
                        if (randomCustomer.special === 'jion') {
                            const specialRecipe = GAME_DATA.recipes.jionSpecial;
                            setCurrentAnimal(randomCustomer);
                            setCurrentRecipe(specialRecipe);
                            setCurrentOrders([specialRecipe]);
                        } else {
                            let availableRecipes;

                            if (level === 3) {
                                // Level 3: 3ë‹¨ê³„ ìš”ë¦¬ë§Œ ë‚˜ì˜´ (ì–´ë ¤ì›€)
                                availableRecipes = Object.values(GAME_DATA.recipes).filter(r => r.level === 3 && !r.isFreestyle && !r.special);
                            } else {
                                // ğŸ”¥ Level 4 (ì „ë¬¸ê²½ì˜ì¸): 1, 2, 3ë‹¨ê³„ ëª¨ë“  ìš”ë¦¬ê°€ ì„ì—¬ì„œ ë‚˜ì˜´!
                                availableRecipes = Object.values(GAME_DATA.recipes).filter(r => !r.isFreestyle && !r.special);
                            }

                            const recipe1 = availableRecipes[Math.floor(Math.random() * availableRecipes.length)];
                            let recipe2 = availableRecipes[Math.floor(Math.random() * availableRecipes.length)];
                            let recipe3 = availableRecipes[Math.floor(Math.random() * availableRecipes.length)];
                            
                            // ì¤‘ë³µ ë°©ì§€ ë¡œì§
                            if (availableRecipes.length > 2) {
                                while (recipe2.id === recipe1.id) {
                                    recipe2 = availableRecipes[Math.floor(Math.random() * availableRecipes.length)];
                                }
                                while (recipe3.id === recipe1.id || recipe3.id === recipe2.id) {
                                    recipe3 = availableRecipes[Math.floor(Math.random() * availableRecipes.length)];
                                }
                            }
                            
                            setCurrentAnimal(randomCustomer);
                            setCurrentRecipe(recipe1);
                            setCurrentOrders([recipe1, recipe2, recipe3]);
                        }
                    }
                }

                // ê³µí†µ ì´ˆê¸°í™”
                setCompletedOrders([]);
                setCurrentOrderIndex(0);
                setCookingPot([]);
                setCustomerPayment(0);
                setSelectedChange([]);
                setFailedDish(null);
            };
            
            // ë ˆì‹œí”¼ í™•ì¸í•˜ê¸°
            const viewRecipe = () => {
                setGameStage('recipe');
            };
            
            // ì¡°ë¦¬ ì‹œì‘
            const startCooking = () => {
                setGameStage('cooking');
            };
            
            // ì¬ë£Œ ì¶”ê°€
            const addIngredient = (ingredientId) => {
                SoundSystem.playPop(); // ë˜‘! ì†Œë¦¬
                const newPot = [...cookingPot, ingredientId];
                setCookingPot(newPot);
            };
            
            // ì¬ë£Œ ì œê±°
            const removeIngredient = (index) => {
                const newPot = cookingPot.filter((_, i) => i !== index);
                setCookingPot(newPot);
            };
            
// ìš”ë¦¬í•˜ê¸° ë²„íŠ¼ í´ë¦­
            const startCookingDish = () => {
                // 1. ëƒ„ë¹„ê°€ ë¹„ì—ˆëŠ”ì§€ í™•ì¸
                if (cookingPot.length === 0) {
                    showFeedbackMsg('ğŸ¤” ì¬ë£Œë¥¼ ë¨¼ì € ë„£ì–´ì£¼ì„¸ìš”!', false);
                    return;
                }

                // 2. ì¹œêµ¬ë¥¼ ìœ„í•œ 'ììœ  ìš”ë¦¬'ì¸ì§€ í™•ì¸
                if (currentRecipe && currentRecipe.isFreestyle) {
                    // --- ììœ  ìš”ë¦¬ ì„±ê³µ ë¡œì§ ---
                    SoundSystem.playSuccess();
                    
                    // (1) ê°€ê²© ê³„ì‚°: ê¸°ë³¸ 500ì› + ì¬ë£Œ í•˜ë‚˜ë‹¹ 300ì›
                    const customPrice = 500 + (cookingPot.length * 300);
                    
                    // (2) ì´ë¦„ ì§“ê¸°: ì¬ë£Œ ì´ë¦„ì„ ì¡°í•©
                    const ingredientNames = cookingPot.map(id => GAME_DATA.ingredients[id].name);
                    const uniqueNames = [...new Set(ingredientNames)];
                    
                    let customName = "";
                    if (uniqueNames.length === 1) {
                        customName = `ê°€ë“ì°¬ ${uniqueNames[0]} ìš”ë¦¬`;
                    } else if (uniqueNames.length === 2) {
                        customName = `${uniqueNames[0]}ì™€ ${uniqueNames[1]}ì˜ ë§Œë‚¨`;
                    } else {
                        customName = `${uniqueNames[0]} ë“¬ë¿ ìŠ¤í˜ì…œ ìš”ë¦¬`;
                    }

                    // (3) ì™„ì„±ëœ ìš”ë¦¬ ì •ë³´ ì—…ë°ì´íŠ¸
                    const finishedDish = {
                        ...currentRecipe,
                        name: customName,
                        price: customPrice,
                        emoji: 'ğŸ²', 
                        description: `ì§€ì˜¨ì´ê°€ ${currentAnimal.name}ë¥¼ ìœ„í•´ ë§Œë“  ìš”ë¦¬!`
                    };
                    
                    // ì£¼ë¬¸ ëª©ë¡ ì—…ë°ì´íŠ¸
                    const newOrders = [...currentOrders];
                    newOrders[currentOrderIndex] = finishedDish;
                    setCurrentOrders(newOrders);
                    setCurrentRecipe(finishedDish); 

                    // (4) ì„±ê³µ ì²˜ë¦¬
                    const newCompleted = [...completedOrders, finishedDish];
                    setCompletedOrders(newCompleted);

                    setTimeout(() => {
                        setGameStage('serving');
                    }, 1000);
                    
                    return; // ììœ  ìš”ë¦¬ëŠ” ì—¬ê¸°ì„œ ì¢…ë£Œ
                }

                // --- ê¸°ì¡´ ì¼ë°˜ ìš”ë¦¬ ë¡œì§ (ë™ë¬¼ ì†ë‹˜ìš©) ---
                const recipeSorted = [...currentRecipe.ingredients].sort();
                const potSorted = [...cookingPot].sort();
                const isCorrect = JSON.stringify(recipeSorted) === JSON.stringify(potSorted);

                if (isCorrect) {
                    SoundSystem.playSuccess();
                    setFailedDish(null);
                    
                    const newCompleted = [...completedOrders, currentRecipe];
                    setCompletedOrders(newCompleted);
                    
                    const nextIndex = currentOrderIndex + 1;
                    if (nextIndex < currentOrders.length) {
                        setTimeout(() => {
                            setCurrentOrderIndex(nextIndex);
                            setCurrentRecipe(currentOrders[nextIndex]);
                            setCookingPot([]);
                            setGameStage('cooking');
                            showFeedbackMsg(`ğŸ‰ ${currentRecipe.name} ì™„ì„±! ë‹¤ìŒ ìš”ë¦¬ ê³ ê³ !`, true);
                        }, 1000);
                    } else {
                        setTimeout(() => {
                            setGameStage('serving');
                        }, 1000);
                    }
                } else {
                    // ì‹¤íŒ¨ ë¡œì§
                    SoundSystem.playFail();
                    const weirdDishName = generateWeirdDishName(cookingPot);
                    setFailedDish({
                        name: weirdDishName,
                        ingredients: cookingPot
                    });
                    
                    const ingredientCost = cookingPot.length * 100;
                    setScore(Math.max(0, score - ingredientCost));
                    
                    setTimeout(() => {
                        setGameStage('failed');
                    }, 1000);
                }
            };                    

            // ì´ìƒí•œ ìš”ë¦¬ ì´ë¦„ ìƒì„±
            const generateWeirdDishName = (ingredients) => {
                const names = ingredients.map(id => GAME_DATA.ingredients[id].name);
                const templates = [
                    `${names[0]}${names[1] || ''}ë§› ${names[2] || names[0]}?`,
                    `ëŠë¼í•œ ${names[0]}${names[1] || ''} ì¥¬ìŠ¤`,
                    `${names[0]} ${names[1] || ''}íŠ€ê¹€??`,
                    `ì´ìƒí•œ ${names[0]}${names[1] || ''} ìŠ¤í”„`,
                    `${names[0]}${names[1] || ''}${names[2] || ''}ë³¶ìŒ???`,
                    `${names[0]} ë„£ì€ ${names[1] || names[0]}`,
                    `íƒ„ ${names[0]}${names[1] || ''} ìš”ë¦¬`,
                    `${names[0]}ë‘ ${names[1] || names[0]} ì„ì€ ê±°??`,
                ];
                return templates[Math.floor(Math.random() * templates.length)];
            };
            
            // ì„œë¹™ ì™„ë£Œ í›„ ê³„ì‚°
            const finishServing = () => {
                // ì†ë‹˜ì´ ë‚´ëŠ” ëˆ ìƒì„± (ìš”ë¦¬ ê°€ê²©ë³´ë‹¤ ë§ì´)
                const totalPrice = currentOrders.reduce((sum, recipe) => sum + recipe.price, 0);
                
                // íŠ¹ë³„ ì†ë‹˜ ì²´í¬ (ê³¤ì¶© ì†ë‹˜ê³¼ í­ê·„ì€ ëˆì„ ë” ë§ì´ ëƒ„)
                const isSpecialGuest = ['beetle', 'wasp', 'penguin'].includes(currentAnimal.id);
                
                let possiblePayments;
                if (isSpecialGuest) {
                    // íŠ¹ë³„ ì†ë‹˜: ì²œì› ë‹¨ìœ„ë¡œ ë” ë§ì´ ì§€ë¶ˆ (1000ì› ì§€í ê±°ìŠ¤ë¦„ëˆ ê°€ëŠ¥)
                    possiblePayments = [
                        totalPrice + 1000,
                        totalPrice + 1100,
                        totalPrice + 1200,
                        totalPrice + 1500,
                        totalPrice + 2000,
                        Math.ceil((totalPrice + 1000) / 1000) * 1000, // ì²œì› ë‹¨ìœ„ë¡œ ì˜¬ë¦¼
                    ];
                } else {
                    // ì¼ë°˜ ì†ë‹˜: ë°±ì› ë‹¨ìœ„ ê±°ìŠ¤ë¦„ëˆ
                    possiblePayments = [
                        totalPrice + 100,
                        totalPrice + 200,
                        totalPrice + 300,
                        totalPrice + 500,
                        Math.ceil(totalPrice / 1000) * 1000, // ì²œì› ë‹¨ìœ„ë¡œ ì˜¬ë¦¼
                    ];
                }
                
                const payment = possiblePayments[Math.floor(Math.random() * possiblePayments.length)];
                
                setCustomerPayment(payment);
                setGameStage('payment');
            };
            
            // ê±°ìŠ¤ë¦„ëˆ ì„ íƒ
            const selectChangeMoney = (money) => {
                SoundSystem.playCoin(); // ë™ì „ ì†Œë¦¬
                const newChange = [...selectedChange, money];
                setSelectedChange(newChange);
            };
            
            // ê±°ìŠ¤ë¦„ëˆ ì œê±°
            const removeChangeMoney = (index) => {
                const newChange = selectedChange.filter((_, i) => i !== index);
                setSelectedChange(newChange);
            };
            
            // [ë³€ê²½ë¨] ëˆ ë‚´ê¸° í™•ì¸ (ë¹¼ê¸° ëŒ€ì‹  ê°€ê²© ë§ì¶”ê¸°)
            const checkChange = () => {
                const totalMoney = selectedChange.reduce((sum, money) => sum + money.value, 0);
                // 2ê°œ ì´ìƒ ì£¼ë¬¸ ì‹œ ì´ ê°€ê²© ê³„ì‚°
                const totalPrice = currentOrders.reduce((sum, recipe) => sum + recipe.price, 0);
                
                // ëª©í‘œ: ê±°ìŠ¤ë¦„ëˆì´ ì•„ë‹ˆë¼ 'ìŒì‹ ê°€ê²©' ê·¸ ìì²´ë¥¼ ë§ì¶°ì•¼ í•¨
                const correctAmount = totalPrice;
                
                if (totalMoney === correctAmount) {
                    // ì„±ê³µ!
                    SoundSystem.playSuccess(); // ì„±ê³µ ì†Œë¦¬
                    const newScore = score + totalPrice; // ìˆ˜ìµ ì¶”ê°€
                    setScore(newScore);
                    
                    // ë ˆë²¨ì—… ì²´í¬
                    if (newScore >= 50000 && level === 3) {
                        SoundSystem.playLevelUp();
                        setGameStage('levelup');
                    } else if (newScore >= 10000 && level === 2) {
                        SoundSystem.playLevelUp();
                        setGameStage('levelup');
                    } else if (newScore >= 3000 && level === 1) {
                        SoundSystem.playLevelUp();
                        setGameStage('levelup');
                    } else {
                        setGameStage('result');
                    }
                } else if (totalMoney < correctAmount) {
                    showFeedbackMsg(`ğŸ’° ëˆì´ ${correctAmount - totalMoney}ì› ë¶€ì¡±í•´ìš”! ë” ì˜¬ë ¤ì£¼ì„¸ìš”!`, false);
                } else {
                    showFeedbackMsg(`ğŸ’° ëˆì´ ${totalMoney - correctAmount}ì› ë„˜ì—ˆì–´ìš”! ì¡°ê¸ˆ ëœì–´ë‚´ì„¸ìš”!`, false);
                }
            };
            
            // í”¼ë“œë°± ë©”ì‹œì§€
            const showFeedbackMsg = (message, isSuccess) => {
                setFeedbackMessage(message);
                setShowFeedback(true);
                setTimeout(() => setShowFeedback(false), 2500);
            };
            
            // ë‹¤ìŒ ë¼ìš´ë“œ
            const nextRound = () => {
                generateOrder();
                setGameStage('order');
            };
            
            // ìˆ˜ë™ ì €ì¥
            const handleSave = () => {
                SoundSystem.playPop();
                const gameState = {
                    level,
                    score,
                    gameStage,
                    currentAnimal,
                    currentRecipe,
                    currentOrders,
                    completedOrders,
                    currentOrderIndex,
                    cookingPot,
                    customerPayment,
                    selectedChange,
                    failedDish
                };
                localStorage.setItem('restaurantGameState', JSON.stringify(gameState));
                showFeedbackMsg('ğŸ’¾ ê²Œì„ì´ ì €ì¥ë˜ì—ˆì–´ìš”!', true);
            };
            
            // ê²Œì„ ì´ˆê¸°í™”
            const handleReset = () => {
                if (window.confirm('ğŸ”„ ì •ë§ë¡œ ê²Œì„ì„ ì´ˆê¸°í™”í•˜ì‹œê² ì–´ìš”?\nëª¨ë“  ì§„í–‰ ìƒí™©ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤!')) {
                    SoundSystem.playPop();
                    localStorage.removeItem('restaurantGameState');
                    setGameStage('welcome');
                    setLevel(1);
                    setScore(1000);
                    setCurrentAnimal(null);
                    setCurrentRecipe(null);
                    setCurrentOrders([]);
                    setCompletedOrders([]);
                    setCurrentOrderIndex(0);
                    setCookingPot([]);
                    setCustomerPayment(0);
                    setSelectedChange([]);
                    setFailedDish(null);
                    showFeedbackMsg('ğŸ”„ ê²Œì„ì´ ì´ˆê¸°í™”ë˜ì—ˆì–´ìš”!', true);
                }
            };
            
            return (
                <div className="min-h-screen p-4 md:p-8">
                    <Header level={level} score={score} onSave={handleSave} onReset={handleReset} />
                    
                    <AnimatePresence>
                        {showFeedback && (
                            <FeedbackMessage message={feedbackMessage} />
                        )}
                    </AnimatePresence>
                    
                    <div className="max-w-6xl mx-auto">
                        {gameStage === 'welcome' && <WelcomeScreen onStart={startGame} />}
                        {gameStage === 'order' && (
                            <OrderScreen 
                                animal={currentAnimal}
                                recipe={currentRecipe}
                                orders={currentOrders}
                                level={level}
                                onViewRecipe={viewRecipe}
                            />
                        )}
                        {gameStage === 'recipe' && (
                            <RecipeScreen 
                                recipe={currentRecipe}
                                orders={currentOrders}
                                level={level}
                                onStartCooking={startCooking}
                            />
                        )}
                        {gameStage === 'cooking' && (
                            <CookingScreen
                                recipe={currentRecipe}
                                orders={currentOrders}
                                completedOrders={completedOrders}
                                currentOrderIndex={currentOrderIndex}
                                cookingPot={cookingPot}
                                level={level}
                                onAddIngredient={addIngredient}
                                onRemoveIngredient={removeIngredient}
                                onStartCooking={startCookingDish}
                            />
                        )}
                        {gameStage === 'failed' && (
                            <FailedScreen
                                failedDish={failedDish}
                                ingredientCost={cookingPot.length * 100}
                                onRetry={() => {
                                    setCookingPot([]); // ì¬ë£Œ ì´ˆê¸°í™”
                                    setGameStage('cooking');
                                }}
                            />
                        )}
                        {gameStage === 'serving' && (
                            <ServingScreen
                                animal={currentAnimal}
                                recipe={currentRecipe}
                                onFinish={finishServing}
                            />
                        )}
                        {gameStage === 'payment' && (
                            <PaymentScreen
                                recipe={currentRecipe}
                                orders={currentOrders}
                                customerPayment={customerPayment}
                                selectedChange={selectedChange}
                                onSelectMoney={selectChangeMoney}
                                onRemoveMoney={removeChangeMoney}
                                onCheckChange={checkChange}
                            />
                        )}
                        {gameStage === 'levelup' && (
                            <LevelUpScreen
                                currentLevel={level}
                                newLevel={level + 1}
                                onContinue={() => {
                                    setLevel(level + 1);
                                    setGameStage('result');
                                }}
                            />
                        )}
                        {gameStage === 'result' && (
                            <ResultScreen
                                animal={currentAnimal}
                                recipe={currentRecipe}
                                orders={currentOrders}
                                score={score}
                                onNextRound={nextRound}
                            />
                        )}
                    </div>
                </div>
            );
        }

        // í—¤ë”
        function Header({ level, score, onSave, onReset }) {
            const levelNames = {
                1: 'ìˆ˜ìŠµ ìš”ë¦¬ì‚¬',
                2: 'ìš”ë¦¬ì‚¬',
                3: 'ì „ë¬¸ ìš”ë¦¬ì‚¬',
                4: 'ì „ë¬¸ ê²½ì˜ì¸'
            };
            
            return (
                <motion.div 
                    initial={{ y: -50, opacity: 0 }}
                    animate={{ y: 0, opacity: 1 }}
                    className="text-center mb-8"
                >
                    <h1 className="text-4xl md:text-6xl font-bold text-pink-600 mb-2">
                        ğŸ³ ê¼¬ë§ˆ ìš”ë¦¬ì‚¬ì˜ ë§›ìˆëŠ” ë ˆìŠ¤í† ë‘
                    </h1>
                    <div className="flex justify-center items-center gap-4 flex-wrap">
                        <div className="inline-block bg-white px-6 py-3 rounded-full cute-shadow">
                            <span className="text-2xl md:text-3xl font-bold text-purple-600">
                                â­ {levelNames[level]}
                            </span>
                        </div>
                        <div className="inline-block bg-white px-6 py-3 rounded-full cute-shadow">
                            <span className="text-2xl md:text-3xl font-bold text-green-600">
                                ğŸ’° {score}ì›
                            </span>
                        </div>
                        <motion.button
                            whileHover={{ scale: 1.1 }}
                            whileTap={{ scale: 0.9 }}
                            onClick={onSave}
                            className="bg-blue-500 text-white px-5 py-3 rounded-full cute-shadow text-xl font-bold hover:bg-blue-600 transition-colors"
                            title="ê²Œì„ ì €ì¥í•˜ê¸°"
                        >
                            ğŸ’¾ ì €ì¥
                        </motion.button>
                        <motion.button
                            whileHover={{ scale: 1.1 }}
                            whileTap={{ scale: 0.9 }}
                            onClick={onReset}
                            className="bg-red-500 text-white px-5 py-3 rounded-full cute-shadow text-xl font-bold hover:bg-red-600 transition-colors"
                            title="ê²Œì„ ì´ˆê¸°í™”í•˜ê¸°"
                        >
                            ğŸ”„ ì´ˆê¸°í™”
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // í™˜ì˜ í™”ë©´
        function WelcomeScreen({ onStart }) {
            return (
                <motion.div
                    initial={{ scale: 0.8, opacity: 0 }}
                    animate={{ scale: 1, opacity: 1 }}
                    className="text-center py-12"
                >
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-2xl mx-auto">
                        <div className="text-8xl mb-6 animate-bounce-gentle">ğŸ§‘â€ğŸ³</div>
                        <h2 className="text-3xl md:text-5xl font-bold text-gray-800 mb-4">
                            ë§›ìˆëŠ” ë ˆìŠ¤í† ë‘ì— ì˜¤ì‹  ê±¸<br/>í™˜ì˜í•´ìš”!
                        </h2>
                        <p className="text-xl md:text-2xl text-gray-600 mb-8">
                            ê·€ì—¬ìš´ ë™ë¬¼ ì†ë‹˜ë“¤ì—ê²Œ<br/>
                            ë§›ìˆëŠ” ìš”ë¦¬ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”! ğŸ½ï¸âœ¨<br/>
                            <br/>
                            ê·¸ë¦¬ê³  ê±°ìŠ¤ë¦„ëˆë„ ì •í™•í•˜ê²Œ ê³„ì‚°í•´ì•¼ í•´ìš”! ğŸ’°
                        </p>
                        
                        <div className="space-y-4">
                            <button
                                onClick={() => { SoundSystem.playPop(); onStart(1); }}
                                className="w-full bg-gradient-to-r from-green-400 to-blue-400 text-white text-2xl md:text-3xl font-bold px-12 py-6 rounded-full hover:scale-105 transition-transform cute-shadow"
                            >
                                â­ ìˆ˜ìŠµìš”ë¦¬ì‚¬ë¡œ ì‹œì‘í•˜ê¸°
                            </button>
                            <button
                                onClick={() => { SoundSystem.playPop(); onStart(2); }}
                                className="w-full bg-gradient-to-r from-purple-400 to-pink-400 text-white text-2xl md:text-3xl font-bold px-12 py-6 rounded-full hover:scale-105 transition-transform cute-shadow"
                            >
                                ğŸ‘‘ ìš”ë¦¬ì‚¬ë¡œ ì‹œì‘í•˜ê¸°
                            </button>
                            <button
                                onClick={() => { SoundSystem.playPop(); onStart(3); }}
                                className="w-full bg-gradient-to-r from-orange-400 to-red-400 text-white text-2xl md:text-3xl font-bold px-12 py-6 rounded-full hover:scale-105 transition-transform cute-shadow"
                            >
                                ğŸŒŸ ì „ë¬¸ìš”ë¦¬ì‚¬ë¡œ ì‹œì‘í•˜ê¸°
                            </button>
                        </div>
                        
                        <div className="mt-8 bg-yellow-50 rounded-2xl p-6">
                            <div className="text-xl font-bold text-gray-700 mb-4">ğŸ’¡ ë ˆë²¨ ì•ˆë‚´</div>
                            <div className="space-y-3 text-left text-lg text-gray-600">
                                <div className="flex gap-3">
                                    <div className="font-bold text-green-600">â­ ìˆ˜ìŠµìš”ë¦¬ì‚¬:</div>
                                    <div>1ê°œ ì£¼ë¬¸, ê¸°ë³¸ ì¬ë£Œ</div>
                                </div>
                                <div className="flex gap-3">
                                    <div className="font-bold text-purple-600">ğŸ‘‘ ìš”ë¦¬ì‚¬:</div>
                                    <div>2ê°œ ì£¼ë¬¸, ë” ë§ì€ ì¬ë£Œ</div>
                                </div>
                                <div className="flex gap-3">
                                    <div className="font-bold text-orange-600">ğŸŒŸ ì „ë¬¸ìš”ë¦¬ì‚¬:</div>
                                    <div>3ê°œ ì£¼ë¬¸, ê³¤ì¶© ì†ë‹˜, ìµœê³ ê¸‰ ìš”ë¦¬!</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </motion.div>
            );
        }

// [ìˆ˜ì •ë¨] ì£¼ë¬¸ í™”ë©´ (ììœ  ìš”ë¦¬ì¼ ë•Œ ì¬ë£Œ ì•ˆ ë³´ì—¬ì£¼ê¸°)
        function OrderScreen({ animal, recipe, orders, level, onViewRecipe }) {
            if (!animal || !recipe) return null;
            
            // ì£¼ë¬¸ ëª©ë¡ ê²°ì • (2ê°œ ì´ìƒ ì£¼ë¬¸ì´ë©´ orders ì‚¬ìš©, ì•„ë‹ˆë©´ recipe í•˜ë‚˜ë¥¼ ë°°ì—´ë¡œ)
            const displayOrders = (orders && orders.length > 0) ? orders : [recipe];
            const totalPrice = displayOrders.reduce((sum, r) => sum + r.price, 0);
            
            return (
                <motion.div
                    initial={{ x: -100, opacity: 0 }}
                    animate={{ x: 0, opacity: 1 }}
                    className="py-8"
                >
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-3xl mx-auto">
                        {/* ë ˆë²¨ ë±ƒì§€ */}
                        {level >= 2 && (
                            <div className="text-center mb-4">
                                <span className={`inline-block px-6 py-2 rounded-full font-bold text-xl text-white ${
                                    level === 2 ? 'bg-purple-500' : 
                                    level === 3 ? 'bg-orange-500' : 'bg-blue-500'
                                }`}>
                                    {level === 2 ? 'â­ ìš”ë¦¬ì‚¬' : level === 3 ? 'ğŸŒŸ ì „ë¬¸ìš”ë¦¬ì‚¬' : 'ğŸ’ ì „ë¬¸ê²½ì˜ì¸'}
                                </span>
                            </div>
                        )}
                        
                        {/* ë™ë¬¼ ìºë¦­í„° */}
                        <motion.div
                            animate={{ rotate: [0, -5, 5, -5, 0] }}
                            transition={{ duration: 0.5, repeat: 2 }}
                            className="text-9xl text-center mb-6"
                        >
                            {animal.emoji}
                        </motion.div>
                        
                        <div className="text-center mb-8">
                            <h2 className="text-3xl md:text-4xl font-bold text-gray-800 mb-4">
                                {animal.name} ì†ë‹˜ì´ ì˜¤ì…¨ì–´ìš”! ğŸ‰
                            </h2>
                            {animal.type === 'friend' && (
                                <p className="text-xl text-gray-500 font-bold">{animal.desc}</p>
                            )}
                        </div>
                        
                        {/* ë§í’ì„  */}
                        <motion.div
                            initial={{ scale: 0 }}
                            animate={{ scale: 1 }}
                            transition={{ delay: 0.5, type: "spring" }}
                            className="bg-yellow-100 border-4 border-yellow-300 rounded-2xl p-6 relative mb-8"
                        >
                            <div className="text-2xl md:text-3xl text-center text-gray-700 mb-4">
                                {displayOrders.length > 1 
                                    ? `"${displayOrders.length}ê°œ ì£¼ë¬¸í• ê²Œìš”!"` 
                                    : `"${displayOrders[0].name} ì£¼ì„¸ìš”!"`}
                            </div>

                            <div className="flex flex-wrap justify-center gap-6 mb-4">
                                {displayOrders.map((order, i) => (
                                    <div key={i} className="text-center">
                                        <div className="text-6xl mb-2">{order.emoji}</div>
                                        <div className="text-xl font-bold">{order.name}</div>
                                        {/* ììœ  ìš”ë¦¬ëŠ” ê°€ê²©ì´ 0ì›ì´ë¯€ë¡œ ê°€ê²© í‘œì‹œ ìƒëµ í˜¹ì€ '?' í‘œì‹œ */}
                                        <div className="text-lg text-green-600">
                                            {order.isFreestyle ? 'ê°€ê²©ì€ ë¹„ë°€!' : `${order.price}ì›`}
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            {/* ë§í’ì„  ê¼¬ë¦¬ */}
                            <div className="absolute -top-4 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-[20px] border-r-[20px] border-b-[20px] border-transparent border-b-yellow-300"></div>
                        </motion.div>
                        
                        {/* ì´ ê°€ê²© í‘œì‹œ (ììœ  ìš”ë¦¬ëŠ” ì œì™¸) */}
                        {!recipe.isFreestyle && (
                            <div className="bg-green-50 border-4 border-green-300 rounded-2xl p-6 mb-8">
                                <div className="flex items-center justify-center gap-3">
                                    <span className="text-3xl">ğŸ’°</span>
                                    <span className="text-2xl md:text-3xl font-bold text-green-700">
                                        ì´ ê°€ê²©: {totalPrice}ì›
                                    </span>
                                </div>
                            </div>
                        )}
                        
                        <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={onViewRecipe}
                            className="w-full bg-gradient-to-r from-orange-400 to-pink-400 text-white text-2xl md:text-3xl font-bold py-6 rounded-full cute-shadow"
                        >
                            {recipe.isFreestyle ? 'ğŸ ìš”ë¦¬í•˜ëŸ¬ ê°€ê¸°!' : 'ğŸ“– ë ˆì‹œí”¼ í™•ì¸í•˜ê¸°!'}
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

// [ìˆ˜ì •ë¨] ë ˆì‹œí”¼ í™”ë©´ (ì¹œêµ¬ ìš”ë¦¬ì¼ ë•Œ ë„êµ¬ ì°¾ê¸° ì—ëŸ¬ í•´ê²°)
        function RecipeScreen({ recipe, orders, level, onStartCooking }) {
            if (!recipe) return null;
            
            const [showRecipe, setShowRecipe] = useState(false);
            const isMultipleOrders = orders && orders.length > 1;
            
            // ì£¼ë¬¸ ëª©ë¡ (ì—†ìœ¼ë©´ í˜„ì¬ ë ˆì‹œí”¼ 1ê°œ)
            const currentOrderList = isMultipleOrders ? orders : [recipe];
            
            // ğŸ”¥ [ì¤‘ìš” Fix] ì¹œêµ¬ ìš”ë¦¬(ììœ  ìš”ë¦¬)ë¼ë©´, ë³µì¡í•œ ë¡œì§ ì—†ì´ ë°”ë¡œ "ìš”ë¦¬ ì‹œì‘" í™”ë©´ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
            // ì—¬ê¸°ì„œ ë„êµ¬(tool)ë¥¼ ì°¾ì§€ ì•Šìœ¼ë¯€ë¡œ ì—ëŸ¬ê°€ ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            if (recipe.isFreestyle) {
                return (
                    <motion.div
                        initial={{ scale: 0.8, opacity: 0 }}
                        animate={{ scale: 1, opacity: 1 }}
                        className="py-8"
                    >
                        <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-3xl mx-auto text-center">
                            <h2 className="text-3xl md:text-4xl font-bold text-purple-600 mb-6">
                                ğŸ ì¹œêµ¬ë¥¼ ìœ„í•œ íŠ¹ë³„ ìš”ë¦¬!
                            </h2>
                            <div className="text-9xl mb-8 animate-bounce-gentle">ğŸ§‘â€ğŸ³</div>
                            <p className="text-2xl text-gray-600 mb-8 leading-relaxed">
                                ì •í•´ì§„ ë ˆì‹œí”¼ê°€ ì—†ì–´ìš”!<br/>
                                ì¹œêµ¬ê°€ ì¢‹ì•„í•˜ëŠ” ì¬ë£Œë¥¼<br/>
                                <strong>ë§ˆìŒëŒ€ë¡œ</strong> ë„£ì–´ë³´ì„¸ìš”!<br/>
                            </p>
                            <motion.button
                                whileHover={{ scale: 1.05 }}
                                whileTap={{ scale: 0.95 }}
                                onClick={onStartCooking}
                                className="w-full bg-gradient-to-r from-green-400 to-blue-400 text-white text-2xl md:text-3xl font-bold py-6 rounded-full cute-shadow"
                            >
                                ğŸ³ ìš”ë¦¬ ì‹œì‘í•˜ê¸°!
                            </motion.button>
                        </div>
                    </motion.div>
                );
            }

            // --- ì•„ë˜ëŠ” ì¼ë°˜ ë™ë¬¼ ì†ë‹˜ì„ ìœ„í•œ ë¡œì§ì…ë‹ˆë‹¤ ---
            
            // ì¼ë°˜ ìš”ë¦¬ì¼ ë•Œë§Œ ë„êµ¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. (ì—ëŸ¬ ë°©ì§€ìš© ì•ˆì „ì¥ì¹˜ || ì¶”ê°€)
            const tool = COOKING_TOOLS[recipe.cookingTool] || COOKING_TOOLS['pot'];

            // recipeê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë ˆì‹œí”¼ ê³µê°œ ìƒíƒœ ì´ˆê¸°í™”
            useEffect(() => {
                setShowRecipe(false);
            }, [recipe.id]);

            return (
                <motion.div
                    initial={{ scale: 0.8, opacity: 0 }}
                    animate={{ scale: 1, opacity: 1 }}
                    className="py-8"
                >
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-3xl mx-auto">
                        <h2 className="text-3xl md:text-4xl font-bold text-center text-purple-600 mb-6">
                            {isMultipleOrders ? "ğŸ“– ì˜¤ëŠ˜ì˜ ì£¼ë¬¸ì„œ" : `ğŸ“– ${recipe.name} ë ˆì‹œí”¼`}
                        </h2>

                        {/* ìš”ë¦¬ ì•„ì´ì½˜ ë³´ì—¬ì£¼ê¸° */}
                        <div className="flex justify-center gap-6 mb-8">
                            {currentOrderList.map((order, i) => (
                                <div key={i} className="text-center">
                                    <div className="text-6xl md:text-8xl mb-2">{order.emoji}</div>
                                    {isMultipleOrders && <div className="text-xl font-bold">{order.name}</div>}
                                </div>
                            ))}
                        </div>
                        
                        {!showRecipe ? (
                            <motion.div
                                whileHover={{ scale: 1.02 }}
                                whileTap={{ scale: 0.98 }}
                                onClick={() => setShowRecipe(true)}
                                className="bg-gradient-to-br from-purple-200 to-pink-200 border-4 border-purple-300 rounded-2xl p-12 mb-6 cursor-pointer text-center"
                            >
                                <div className="text-6xl mb-4">ğŸ”’</div>
                                <div className="text-2xl md:text-3xl font-bold text-purple-700 mb-2">
                                    ë ˆì‹œí”¼ë¥¼ í™•ì¸í•˜ë ¤ë©´ í´ë¦­!
                                </div>
                                <div className="text-lg text-purple-600">
                                    ì¬ë£Œë¥¼ ê¸°ì–µí•´ë³´ì„¸ìš”! ğŸ§ 
                                </div>
                            </motion.div>
                        ) : (
                            <div className="space-y-6 mb-8">
                                {currentOrderList.map((order, orderIndex) => {
                                    // ì—¬ê¸°ì„œë„ ì•ˆì „í•˜ê²Œ ë„êµ¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤
                                    const orderTool = COOKING_TOOLS[order.cookingTool] || COOKING_TOOLS['pot'];
                                    return (
                                        <motion.div
                                            key={orderIndex}
                                            initial={{ scale: 0.8, opacity: 0 }}
                                            animate={{ scale: 1, opacity: 1 }}
                                            transition={{ delay: orderIndex * 0.2 }}
                                            className="bg-blue-50 border-4 border-blue-200 rounded-2xl p-6"
                                        >
                                            <h3 className="text-xl font-bold text-center text-blue-700 mb-4">
                                                {isMultipleOrders ? `${order.name} ì¬ë£Œ` : "ğŸ¥˜ í•„ìš”í•œ ì¬ë£Œ"}
                                            </h3>
                                            <div className="flex flex-wrap justify-center gap-3 mb-4">
                                                {order.ingredients.map((ingredientId, idx) => {
                                                    const ingredient = GAME_DATA.ingredients[ingredientId];
                                                    return (
                                                        <div key={idx} className="bg-white rounded-xl p-3 cute-shadow">
                                                            <div className="text-4xl text-center mb-1">{ingredient.emoji}</div>
                                                            <div className="text-sm font-bold text-center">{ingredient.name}</div>
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                            <div className={`${orderTool.color} rounded-xl p-3 text-center mx-auto w-fit`}>
                                                <span className="text-2xl mr-2">{orderTool.emoji}</span>
                                                <span className="font-bold">{orderTool.name}</span>ì— ë„£ìœ¼ì„¸ìš”!
                                            </div>
                                        </motion.div>
                                    );
                                })}
                            </div>
                        )}
                        
                        <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={onStartCooking}
                            className="w-full bg-gradient-to-r from-green-400 to-blue-400 text-white text-2xl md:text-3xl font-bold py-6 rounded-full cute-shadow"
                        >
                            ğŸ‘¨â€ğŸ³ ìš”ë¦¬ ì‹œì‘í•˜ê¸°!
                        </motion.button>
                    </div>
                </motion.div>
            );
        }


// [ìˆ˜ì •ë¨] ì¡°ë¦¬ í™”ë©´ (ììœ  ìš”ë¦¬ ì§€ì›)
        function CookingScreen({ recipe, orders, completedOrders, currentOrderIndex, cookingPot, level, onAddIngredient, onRemoveIngredient, onStartCooking }) {
            if (!recipe) return null;
            
            const [showRecipe, setShowRecipe] = useState(false);
            
            // ì•ˆì „ì¥ì¹˜: ì¡°ë¦¬ ë„êµ¬ê°€ ì—†ìœ¼ë©´(ììœ ìš”ë¦¬) 'pot'ìœ¼ë¡œ ì²˜ë¦¬
            const toolKey = recipe.cookingTool === 'any' ? 'pot' : recipe.cookingTool;
            const tool = COOKING_TOOLS[toolKey] || COOKING_TOOLS['pot'];
            
            const isMultipleOrders = orders && orders.length > 1;
            
            // í•„ìš”í•œ ì¬ë£Œ ê³„ì‚° (ììœ  ìš”ë¦¬ëŠ” ë¹ˆ ê°ì²´)
            const neededIngredients = recipe.isFreestyle ? {} : recipe.ingredients.reduce((acc, id) => {
                acc[id] = (acc[id] || 0) + 1;
                return acc;
            }, {});
            
            const currentIngredients = cookingPot.reduce((acc, id) => {
                acc[id] = (acc[id] || 0) + 1;
                return acc;
            }, {});
            
            useEffect(() => {
                setShowRecipe(false);
            }, [recipe.id]);
            
            return (
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    {/* ì™¼ìª½: ì¬ë£Œ ì„ íƒ */}
                    <div className="lg:col-span-2">
                        <div className="bg-white rounded-3xl p-6 md:p-8 cute-shadow">
                            <h2 className="text-3xl md:text-4xl font-bold text-center text-purple-600 mb-6">
                                ğŸ¥¬ ì¬ë£Œ ì°½ê³ 
                            </h2>
                            
                            <div className="grid grid-cols-3 md:grid-cols-5 gap-4">
                                {Object.values(GAME_DATA.ingredients).filter(ing => ing.level <= (level === 1 ? 1 : level)).map((ingredient) => (
                                    <motion.button
                                        key={ingredient.id}
                                        whileHover={{ scale: 1.05 }}
                                        whileTap={{ scale: 0.95 }}
                                        onClick={() => onAddIngredient(ingredient.id)}
                                        className="clickable bg-gradient-to-br from-yellow-100 to-orange-100 rounded-2xl p-4 md:p-6 cute-shadow hover:shadow-2xl transition-all"
                                    >
                                        <div className="text-4xl md:text-5xl mb-2">{ingredient.emoji}</div>
                                        <div className="text-sm md:text-base font-bold text-gray-800">{ingredient.name}</div>
                                    </motion.button>
                                ))}
                            </div>
                        </div>
                    </div>
                    
                    {/* ì˜¤ë¥¸ìª½: ì¡°ë¦¬ ë„êµ¬ */}
                    <div className="space-y-6">
                        {/* ì§„í–‰ ìƒí™© (ìš”ë¦¬ì‚¬ë§Œ) */}
                        {isMultipleOrders && (
                            <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-3xl p-4 cute-shadow">
                                <div className="text-center mb-3">
                                    <span className="text-lg font-bold text-purple-700">
                                        ğŸ‘‘ ìš”ë¦¬ ì§„í–‰ ìƒí™©
                                    </span>
                                </div>
                                <div className="flex justify-center gap-3">
                                    {orders.map((order, index) => (
                                        <div key={index} className={`flex flex-col items-center p-3 rounded-xl ${
                                            index < currentOrderIndex ? 'bg-green-200' :
                                            index === currentOrderIndex ? 'bg-yellow-200 ring-4 ring-yellow-400' : 'bg-gray-200'
                                        }`}>
                                            <div className="text-3xl mb-1">{order.emoji}</div>
                                            <div className="text-xs font-bold text-center">{order.name}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                        
                        {/* ë ˆì‹œí”¼ ìš”ì•½ (ììœ  ìš”ë¦¬ëŠ” ìˆ¨ê¹€) */}
                        {!recipe.isFreestyle && (
                            <div className="bg-white rounded-3xl p-6 cute-shadow">
                                <h3 className="text-2xl font-bold text-center text-gray-800 mb-4">ğŸ“‹ ë ˆì‹œí”¼</h3>
                                <div className="space-y-2">
                                    {Object.entries(neededIngredients).map(([id, count]) => {
                                        const ingredient = GAME_DATA.ingredients[id];
                                        const current = currentIngredients[id] || 0;
                                        const isComplete = current === count;
                                        return (
                                            <div key={id} className={`flex items-center justify-between p-3 rounded-xl ${isComplete ? 'bg-green-50' : 'bg-gray-50'}`}>
                                                <div className="flex items-center gap-2">
                                                    <span className="text-2xl">{ingredient.emoji}</span>
                                                    <span className="font-bold">{ingredient.name}</span>
                                                </div>
                                                <span className={`text-xl font-bold ${isComplete ? 'text-green-600' : 'text-gray-600'}`}>
                                                    {current} / {count}
                                                </span>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}
                        
                        {/* ì¡°ë¦¬ ë„êµ¬ */}
                        <div className={`${tool.color} rounded-3xl p-6 cute-shadow border-4 border-opacity-50`}>
                            <h3 className="text-2xl font-bold text-center text-gray-800 mb-4">
                                {recipe.isFreestyle ? 'âœ¨ ë§ˆë²•ì˜ ëƒ„ë¹„' : `${tool.emoji} ${tool.name}`}
                            </h3>
                            
                            <div className="min-h-[200px] bg-white bg-opacity-50 rounded-2xl p-4 mb-4">
                                <div className="flex flex-wrap gap-2 justify-center">
                                    <AnimatePresence>
                                        {cookingPot.length === 0 ? (
                                            <div className="text-center text-gray-400 text-lg py-8 w-full">
                                                {recipe.isFreestyle ? 'ì¢‹ì•„í•˜ëŠ” ì¬ë£Œë¥¼ ë„£ì–´ë³´ì„¸ìš”!' : 'ì¬ë£Œë¥¼ ë„£ì–´ì£¼ì„¸ìš”!'}
                                            </div>
                                        ) : (
                                            cookingPot.map((ingredientId, index) => {
                                                const ingredient = GAME_DATA.ingredients[ingredientId];
                                                return (
                                                    <motion.button
                                                        key={`${ingredientId}-${index}`}
                                                        initial={{ scale: 0, rotate: -180 }}
                                                        animate={{ scale: 1, rotate: 0 }}
                                                        exit={{ scale: 0 }}
                                                        onClick={() => onRemoveIngredient(index)}
                                                        className="bg-white rounded-xl p-3 cute-shadow"
                                                    >
                                                        <div className="text-3xl">{ingredient.emoji}</div>
                                                    </motion.button>
                                                );
                                            })
                                        )}
                                    </AnimatePresence>
                                </div>
                            </div>
                            
                            <motion.button
                                whileHover={{ scale: cookingPot.length > 0 ? 1.05 : 1 }}
                                onClick={onStartCooking}
                                className={`w-full py-4 rounded-2xl text-xl font-bold ${
                                    cookingPot.length > 0 ? 'bg-gradient-to-r from-orange-400 to-red-400 text-white cute-shadow' : 'bg-gray-300 text-gray-500'
                                }`}
                            >
                                {cookingPot.length > 0 ? 'ğŸ”¥ ìš”ë¦¬í•˜ê¸°!' : 'ì¬ë£Œë¥¼ ë„£ì–´ì£¼ì„¸ìš”'}
                            </motion.button>
                        </div>
                    </div>
                </div>
            );
        }
        // ì‹¤íŒ¨ í™”ë©´
        function FailedScreen({ failedDish, ingredientCost, onRetry }) {
            if (!failedDish) return null;
            
            return (
                <motion.div
                    initial={{ scale: 0.5, opacity: 0 }}
                    animate={{ scale: 1, opacity: 1 }}
                    className="py-12"
                >
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-2xl mx-auto text-center">
                        <div className="text-8xl mb-6">ğŸ˜…</div>
                        
                        <h2 className="text-3xl md:text-4xl font-bold text-orange-600 mb-4">
                            ì•—! ì‹¤íŒ¨í–ˆì–´ìš”!
                        </h2>
                        
                        <motion.div
                            animate={{ 
                                scale: [1, 1.1, 1],
                                rotate: [0, -5, 5, 0]
                            }}
                            transition={{ duration: 0.5, repeat: 3 }}
                            className="text-8xl mb-6"
                        >
                            ğŸ¤¢
                        </motion.div>
                        
                        <div className="bg-red-50 border-4 border-red-300 rounded-2xl p-6 mb-6">
                            <div className="text-2xl md:text-3xl font-bold text-red-700 mb-4">
                                {failedDish.name}
                            </div>
                            <div className="flex flex-wrap justify-center gap-3 mb-4">
                                {failedDish.ingredients.map((id, index) => {
                                    const ingredient = GAME_DATA.ingredients[id];
                                    return (
                                        <div key={index} className="text-4xl">{ingredient.emoji}</div>
                                    );
                                })}
                            </div>
                            <div className="text-lg text-red-600">
                                ì´ìƒí•œ ì¡°í•©ì´ì—ìš”! ğŸ˜µ
                            </div>
                        </div>
                        
                        <div className="bg-yellow-50 border-4 border-yellow-300 rounded-2xl p-6 mb-8">
                            <div className="text-xl font-bold text-gray-700 mb-2">ì¬ë£Œë¹„ ì°¨ê°</div>
                            <div className="text-4xl font-bold text-red-600">-{ingredientCost}ì› ğŸ’¸</div>
                            <div className="text-sm text-gray-600 mt-2">
                                (ì¬ë£Œ {failedDish.ingredients.length}ê°œ Ã— 100ì›)
                            </div>
                        </div>
                        
                        <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={onRetry}
                            className="bg-gradient-to-r from-blue-400 to-purple-400 text-white text-2xl md:text-3xl font-bold px-12 py-6 rounded-full cute-shadow"
                        >
                            ğŸ”„ ë‹¤ì‹œ ë„ì „í•˜ê¸°!
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // [ë³€ê²½ë¨] ì„œë¹™ í™”ë©´ (í•˜íŠ¸ ë¿…ë¿… íš¨ê³¼ ì¶”ê°€!)
        function ServingScreen({ animal, recipe, onFinish }) {
            useEffect(() => {
                // ëƒ ëƒ  ì†Œë¦¬ ì¬ìƒ
                setTimeout(() => {
                    SoundSystem.playEating();
                }, 500);
                
                // 4ì´ˆ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ
                const timer = setTimeout(() => {
                    onFinish();
                }, 4000);
                return () => clearTimeout(timer);
            }, []);
            
            // í•˜íŠ¸ ì• ë‹ˆë©”ì´ì…˜ ì„¤ì •
            const heartVariants = {
                initial: { y: 0, opacity: 0, scale: 0.5 },
                animate: i => ({
                    y: -100 - Math.random() * 50, // ìœ„ë¡œ ë– ì˜¤ë¦„
                    opacity: [0, 1, 0], // ë‚˜íƒ€ë‚¬ë‹¤ ì‚¬ë¼ì§
                    scale: [1, 1.5, 1], // ì»¤ì¡Œë‹¤ ì‘ì•„ì§
                    transition: {
                        delay: i * 0.3, // ìˆœì°¨ì ìœ¼ë¡œ ë‚˜íƒ€ë‚¨
                        duration: 2,
                        repeat: Infinity, // ë°˜ë³µ
                        repeatType: "loop"
                    }
                })
            };

            return (
                <motion.div
                    initial={{ scale: 0.5, opacity: 0 }}
                    animate={{ scale: 1, opacity: 1 }}
                    className="py-12"
                >
                    {/* relativeì™€ overflow-hidden ì¶”ê°€í•˜ì—¬ í•˜íŠ¸ê°€ ë°•ìŠ¤ ì•ˆì—ì„œë§Œ ë³´ì´ê²Œ í•¨ */}
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-2xl mx-auto text-center relative overflow-hidden">
                        
                        {/* âœ¨ ì—¬ê¸°ë¶€í„° í•˜íŠ¸ íš¨ê³¼ ì¶”ê°€ âœ¨ */}
                        <div className="absolute inset-0 pointer-events-none">
                            {[...Array(5)].map((_, i) => (
                                <motion.div
                                    key={i}
                                    custom={i}
                                    variants={heartVariants}
                                    initial="initial"
                                    animate="animate"
                                    className="absolute text-5xl md:text-6xl"
                                    style={{
                                        // í•˜íŠ¸ ìœ„ì¹˜ë¥¼ ë™ë¬¼ ì£¼ë³€ìœ¼ë¡œ ëœë¤í•˜ê²Œ ë°°ì¹˜
                                        left: `${20 + Math.random() * 60}%`,
                                        top: `${40 + Math.random() * 30}%`,
                                        zIndex: 0 // ë™ë¬¼ ë’¤ì— ë°°ì¹˜
                                    }}
                                >
                                    {/* ëœë¤í•œ í•˜íŠ¸ ì´ëª¨ì§€ */}
                                    {['ğŸ’–', 'ğŸ’', 'ğŸ¥°', 'ğŸ’—', 'ğŸ˜'][i % 5]}
                                </motion.div>
                            ))}
                        </div>
                        {/* âœ¨ ì—¬ê¸°ê¹Œì§€ í•˜íŠ¸ íš¨ê³¼ ì¶”ê°€ âœ¨ */}

                        <h2 className="text-3xl md:text-4xl font-bold text-gray-800 mb-6 relative z-10">
                            ğŸ½ï¸ ìš”ë¦¬ ì™„ì„±!
                        </h2>
                        
                        <motion.div
                            animate={{ 
                                scale: [1, 1.2, 1],
                                rotate: [0, 5, -5, 0]
                            }}
                            transition={{ duration: 1, repeat: Infinity }}
                            className="text-9xl mb-6 relative z-10"
                        >
                            {recipe.emoji}
                        </motion.div>
                        
                        <div className="text-2xl md:text-3xl font-bold text-purple-600 mb-8 relative z-10">
                            {recipe.name}
                        </div>
                        
                        {/* ë™ë¬¼ì´ ê¸°ë»ì„œ ì¶¤ì¶”ëŠ” ë™ì‘ì„ ì¢€ ë” í¬ê²Œ ë³€ê²½ */}
                        <motion.div
                            animate={{ 
                                rotate: [0, -15, 15, -15, 15, 0],
                                scale: [1, 1.1, 1, 1.1, 1]
                            }}
                            transition={{ duration: 0.8, repeat: Infinity, repeatDelay: 0.2 }}
                            className="text-8xl mb-6 relative z-10"
                        >
                            {animal.emoji}
                        </motion.div>
                        
                        <motion.div
                            initial={{ opacity: 0, y: 20 }}
                            animate={{ opacity: 1, y: 0 }}
                            transition={{ delay: 0.5 }}
                            className="text-2xl md:text-3xl text-gray-700 relative z-10 font-bold"
                        >
                            "{animal.name}{getJosa(animal.name, 'ì´/ê°€')} ë„ˆë¬´ í–‰ë³µí•´í•´ìš”! ğŸ˜"
                        </motion.div>
                        
                        <div className="mt-8 text-lg text-gray-500 relative z-10">
                            ì ì‹œ í›„ ê³„ì‚° ë‹¨ê³„ë¡œ ì´ë™í•©ë‹ˆë‹¤...
                        </div>
                    </div>
                </motion.div>
            );
        }

// [ë³€ê²½ë¨] ê³„ì‚° í™”ë©´ (ì´ì•¡ ìˆ¨ê¸°ê¸° & ë§ì…ˆ ìˆ˜ì‹ ë³´ì—¬ì£¼ê¸°)
        function PaymentScreen({ recipe, orders, customerPayment, selectedChange, onSelectMoney, onRemoveMoney, onCheckChange }) {
            const isMultipleOrders = orders && orders.length > 0;
            // ì£¼ë¬¸ ëª©ë¡ì´ ì—†ìœ¼ë©´(1ë‹¨ê³„) í˜„ì¬ ë ˆì‹œí”¼ë¥¼ ë°°ì—´ë¡œ ë§Œë“¦
            const currentOrderList = isMultipleOrders ? orders : [recipe];
            
            // ì •ë‹µ (ì´ ê°€ê²©)
            const totalPrice = currentOrderList.reduce((sum, r) => sum + r.price, 0);
            
            // í˜„ì¬ ì•„ì´ê°€ ì˜¬ë¦° ëˆì˜ í•©ê³„
            const currentMoney = selectedChange.reduce((sum, money) => sum + money.value, 0);
            
            // ì •ë‹µ ì²´í¬ (ê°€ê²©ê³¼ ì˜¬ë¦° ëˆì´ ê°™ì•„ì•¼ í•¨)
            const canSubmit = currentMoney === totalPrice;
            
            return (
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    {/* ì™¼ìª½: ë¬¸ì œ í™”ë©´ (ìˆ˜ì‹) */}
                    <div className="bg-white rounded-3xl p-6 md:p-8 cute-shadow border-4 border-blue-100">
                        <h2 className="text-3xl md:text-4xl font-bold text-center text-blue-600 mb-8">
                            ğŸ§® ì–¼ë§ˆì¼ê¹Œìš”?
                        </h2>
                        
                        {/* ë§ì…ˆ ìˆ˜ì‹ ì˜ì—­ */}
                        <div className="flex flex-wrap justify-center items-center gap-2 md:gap-4 mb-8">
                            {currentOrderList.map((item, index) => (
                                <React.Fragment key={index}>
                                    {/* ì²« ë²ˆì§¸ ìš”ë¦¬ê°€ ì•„ë‹ˆë©´ ë”í•˜ê¸° í‘œì‹œ ì¶”ê°€ */}
                                    {index > 0 && (
                                        <div className="text-3xl md:text-4xl font-bold text-gray-400 animate-pulse">
                                            +
                                        </div>
                                    )}

                                    {/* ìš”ë¦¬ ì¹´ë“œ (ì´ë¯¸ì§€ + ì´ë¦„ + ê°€ê²©) */}
                                    <div className="flex flex-col items-center bg-white border-2 border-gray-200 rounded-2xl p-3 shadow-sm">
                                        <div className="text-5xl md:text-6xl mb-2">{item.emoji}</div>
                                        <div className="text-sm font-bold text-gray-500 mb-1">{item.name}</div>
                                        <div className="bg-blue-100 text-blue-700 px-3 py-1 rounded-full font-bold text-lg md:text-xl">
                                            {item.price}
                                        </div>
                                    </div>
                                </React.Fragment>
                            ))}

                            {/* ë“±í˜¸(=) í‘œì‹œ */}
                            <div className="text-3xl md:text-4xl font-bold text-gray-400">
                                =
                            </div>

                            {/* ì •ë‹µ ë¬¼ìŒí‘œ (ëˆì„ ë§ì¶”ë©´ ê°€ê²©ì´ ë³´ì„) */}
                            <div className={`rounded-2xl p-4 border-4 transition-all duration-500 ${
                                canSubmit 
                                ? 'bg-green-100 border-green-400 scale-110' 
                                : 'bg-gray-100 border-gray-300'
                            }`}>
                                <div className={`text-4xl md:text-5xl font-bold ${
                                    canSubmit ? 'text-green-600' : 'text-gray-400'
                                }`}>
                                    {canSubmit ? `${totalPrice}` : '?'}
                                </div>
                            </div>
                        </div>

                        {/* íŒíŠ¸ ë©”ì‹œì§€ */}
                        <div className="bg-yellow-50 rounded-xl p-4 text-center border-2 border-yellow-200">
                            <p className="text-lg font-bold text-yellow-800">
                                ìš”ë¦¬ ê°€ê²©ì„ ëª¨ë‘ ë”í•´ì„œ<br/>
                                <span className="text-blue-600 text-2xl">ë¬¼ìŒí‘œ(?)</span>ë¥¼ ë§ì¶°ë³´ì„¸ìš”!
                            </p>
                        </div>
                    </div>
                    
                    {/* ì˜¤ë¥¸ìª½: ëˆ ë‚´ê¸° (ê¸°ì¡´ ìœ ì§€) */}
                    <div className="space-y-6">
                        <div className="bg-white rounded-3xl p-6 cute-shadow">
                            <h3 className="text-2xl font-bold text-center text-gray-800 mb-4">
                                ğŸ’´ ì§€ê°‘ì—ì„œ ëˆ êº¼ë‚´ê¸°
                            </h3>
                            
                            {/* ëˆ ì„ íƒ ë²„íŠ¼ë“¤ */}
                            <div className="grid grid-cols-3 gap-4 mb-6">
                                {GAME_DATA.money.map((money, index) => (
                                    <motion.button
                                        key={index}
                                        whileHover={{ scale: 1.05 }}
                                        whileTap={{ scale: 0.95 }}
                                        onClick={() => onSelectMoney(money)}
                                        className="clickable bg-gradient-to-br from-green-100 to-green-200 border-b-4 border-green-300 rounded-2xl p-4 active:border-b-0 active:translate-y-1 transition-all"
                                    >
                                        <div className="text-4xl mb-2">{money.emoji}</div>
                                        <div className="text-lg font-bold text-green-800">{money.value}ì›</div>
                                    </motion.button>
                                ))}
                            </div>
                        </div>
                        
                        {/* ë‚´ê°€ ì˜¬ë¦° ëˆ í™•ì¸ì°½ */}
                        <div className="bg-white rounded-3xl p-6 cute-shadow">
                            <h3 className="text-2xl font-bold text-center text-gray-800 mb-4">
                                âœ‹ ë‚´ê°€ ì˜¬ë¦° ëˆ
                            </h3>
                            
                            <div className="min-h-[120px] bg-gray-50 rounded-2xl p-4 mb-4 border-2 border-dashed border-gray-300">
                                <div className="flex flex-wrap gap-2 justify-center">
                                    <AnimatePresence>
                                        {selectedChange.length === 0 ? (
                                            <div className="text-center text-gray-400 py-8 w-full flex flex-col items-center">
                                                <span className="text-4xl mb-2">ğŸ‘†</span>
                                                ìœ„ì—ì„œ ëˆì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!
                                            </div>
                                        ) : (
                                            selectedChange.map((money, index) => (
                                                <motion.button
                                                    key={`${money.value}-${index}`}
                                                    initial={{ scale: 0, y: 20 }}
                                                    animate={{ scale: 1, y: 0 }}
                                                    exit={{ scale: 0 }}
                                                    whileHover={{ scale: 1.1 }}
                                                    onClick={() => onRemoveMoney(index)}
                                                    className="bg-white border border-gray-200 rounded-xl p-2 shadow-sm cursor-pointer hover:bg-red-50"
                                                >
                                                    <div className="text-2xl">{money.emoji}</div>
                                                    <div className="text-xs font-bold">{money.value}</div>
                                                </motion.button>
                                            ))
                                        )}
                                    </AnimatePresence>
                                </div>
                            </div>
                            
                            {/* í•©ê³„ í‘œì‹œ (íŒíŠ¸) */}
                            <div className={`rounded-xl p-4 mb-4 transition-colors duration-300 ${
                                canSubmit ? 'bg-green-100' : 'bg-blue-50'
                            }`}>
                                <div className="flex justify-between items-center">
                                    <span className="font-bold text-gray-600">ì§€ê¸ˆ í•©ê³„:</span>
                                    <span className={`text-3xl font-bold ${
                                        canSubmit ? 'text-green-600' : 
                                        currentMoney > totalPrice ? 'text-red-500' : 'text-blue-600'
                                    }`}>
                                        {currentMoney}ì›
                                    </span>
                                </div>
                                {!canSubmit && currentMoney > totalPrice && (
                                    <div className="text-center text-red-500 text-sm font-bold mt-2 animate-bounce">
                                        ëˆì´ ë„ˆë¬´ ë§ì•„ìš”! ë™ì „ì„ ëˆŒëŸ¬ì„œ ë¹¼ì£¼ì„¸ìš”.
                                    </div>
                                )}
                            </div>
                            
                            <motion.button
                                whileHover={{ scale: canSubmit ? 1.05 : 1 }}
                                whileTap={{ scale: canSubmit ? 0.95 : 1 }}
                                onClick={onCheckChange}
                                disabled={!canSubmit}
                                className={`w-full py-5 rounded-2xl text-xl font-bold transition-all ${
                                    canSubmit
                                        ? 'bg-gradient-to-r from-green-500 to-blue-500 text-white shadow-lg cursor-pointer animate-pulse'
                                        : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                }`}
                            >
                                {canSubmit ? 'âœ… ëˆ ë‚´ê¸°!' : `ê°€ê²©ì„ ë§ì¶°ì£¼ì„¸ìš”`}
                            </motion.button>
                        </div>
                    </div>
                </div>
            );
        }
        // ë ˆë²¨ì—… í™”ë©´
        function LevelUpScreen({ currentLevel, newLevel, onContinue }) {
            const levelInfo = {
                2: {
                    icon: 'ğŸ‘‘',
                    name: 'ìš”ë¦¬ì‚¬',
                    color: 'text-purple-600',
                    bgColor: 'from-purple-100 to-pink-100',
                    requirement: '3,000ì›',
                    features: [
                        { emoji: 'ğŸœ', text: 'ìƒˆë¡œìš´ ìš”ë¦¬ 5ì¢… ì¶”ê°€!' },
                        { emoji: 'ğŸ¥’', text: 'ìƒˆë¡œìš´ ì¬ë£Œ 5ì¢… ì¶”ê°€!' },
                        { emoji: 'ğŸ‘¥', text: 'ì†ë‹˜ì´ 2ê°œì”© ì£¼ë¬¸í•´ìš”!' },
                        { emoji: 'ğŸ”„', text: '2ê°œ ìš”ë¦¬ë¥¼ ìˆœì„œëŒ€ë¡œ ë§Œë“¤ì–´ìš”!' },
                        { emoji: 'ğŸ§®', text: 'ê³„ì‚°ì´ ë” ë³µì¡í•´ì ¸ìš”!' }
                    ]
                },
                3: {
                    icon: 'ğŸŒŸ',
                    name: 'ì „ë¬¸ìš”ë¦¬ì‚¬',
                    color: 'text-orange-600',
                    bgColor: 'from-orange-100 to-red-100',
                    requirement: '10,000ì›',
                    features: [
                        { emoji: 'ğŸ', text: 'ìµœê³ ê¸‰ ìš”ë¦¬ 6ì¢… ì¶”ê°€!' },
                        { emoji: 'ğŸ¦', text: 'í”„ë¦¬ë¯¸ì—„ ì¬ë£Œ 6ì¢… ì¶”ê°€!' },
                        { emoji: 'ğŸª²', text: 'ê³¤ì¶© ì†ë‹˜ 3ì¢… ë“±ì¥!' },
                        { emoji: 'ğŸ‘¥ğŸ‘¥ğŸ‘¥', text: 'ì†ë‹˜ì´ 3ê°œì”© ì£¼ë¬¸í•´ìš”!' },
                        { emoji: 'ğŸ”„ğŸ”„ğŸ”„', text: '3ê°œ ìš”ë¦¬ë¥¼ ìˆœì„œëŒ€ë¡œ ë§Œë“¤ì–´ìš”!' },
                        { emoji: 'ğŸ§®ğŸ’°', text: 'ê³„ì‚°ì´ ë§¤ìš° ë³µì¡í•´ì ¸ìš”!' }
                    ]
                },
                4: {
                    icon: 'ğŸ’',
                    name: 'ì „ë¬¸ê²½ì˜ì¸',
                    color: 'text-blue-600',
                    bgColor: 'from-blue-100 to-cyan-100',
                    requirement: '50,000ì›',
                    features: [
                        { emoji: 'ğŸ†', text: 'ë ˆìŠ¤í† ë‘ì„ ì™„ì „íˆ ë§ˆìŠ¤í„°í–ˆì–´ìš”!' },
                        { emoji: 'ğŸ’°', text: 'ì—„ì²­ë‚œ ìˆ˜ìµì„ ë‹¬ì„±í–ˆì–´ìš”!' },
                        { emoji: 'â­', text: 'ìµœê³ ì˜ ìš”ë¦¬ì‚¬ê°€ ë˜ì…¨ì–´ìš”!' },
                        { emoji: 'ğŸ‰', text: 'ì¶•í•˜í•©ë‹ˆë‹¤! ê²Œì„ì„ ê³„ì†í•˜ì„¸ìš”!' }
                    ]
                }
            };
            
            const info = levelInfo[newLevel];
            
            return (
                <motion.div
                    initial={{ scale: 0.5, opacity: 0 }}
                    animate={{ scale: 1, opacity: 1 }}
                    className="py-12"
                >
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-2xl mx-auto text-center">
                        <motion.div
                            animate={{ 
                                rotate: [0, 360],
                                scale: [1, 1.2, 1]
                            }}
                            transition={{ duration: 2, repeat: Infinity }}
                            className="text-9xl mb-6"
                        >
                            â­
                        </motion.div>
                        
                        <h2 className="text-4xl md:text-6xl font-bold text-yellow-600 mb-4">
                            ìŠ¹ì§„í•©ë‹ˆë‹¤! ğŸŠ
                        </h2>
                        
                        <div className="text-8xl mb-6">{info.icon}</div>
                        
                        <p className="text-2xl md:text-3xl text-gray-700 mb-6">
                            {info.requirement} ë‹¬ì„±!<br/>
                            <span className={`text-4xl font-bold ${info.color}`}>{info.name}</span>ë¡œ ìŠ¹ì§„! ğŸš€
                        </p>
                        
                        <div className={`bg-gradient-to-r ${info.bgColor} rounded-2xl p-6 mb-8`}>
                            <div className="text-xl font-bold text-gray-700 mb-4">{info.icon} {info.name} íŠ¹ì§•</div>
                            <div className="space-y-2 text-left">
                                {info.features.map((feature, index) => (
                                    <div key={index} className="flex items-center gap-2">
                                        <span className="text-2xl">{feature.emoji}</span>
                                        <span className="text-lg">{feature.text}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={onContinue}
                            className="bg-gradient-to-r from-yellow-400 to-orange-400 text-white text-2xl md:text-3xl font-bold px-12 py-6 rounded-full cute-shadow"
                        >
                            ğŸ® {info.name}ë¡œ ì‹œì‘í•˜ê¸°!
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // ê²°ê³¼ í™”ë©´
        function ResultScreen({ animal, recipe, orders, score, onNextRound }) {
            const totalEarned = orders ? orders.reduce((sum, r) => sum + r.price, 0) : recipe.price;
            
            return (
                <motion.div
                    initial={{ scale: 0.5, opacity: 0 }}
                    animate={{ scale: 1, opacity: 1 }}
                    className="py-12"
                >
                    <div className="bg-white rounded-3xl p-8 md:p-12 cute-shadow max-w-2xl mx-auto text-center">
                        <div className="text-8xl mb-6">ğŸ‰</div>
                        
                        <h2 className="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
                            ì™„ë²½í•´ìš”!
                        </h2>
                        
                        <motion.div
                            animate={{ 
                                rotate: [0, -10, 10, -10, 10, 0],
                                scale: [1, 1.1, 1]
                            }}
                            transition={{ duration: 1, repeat: Infinity, repeatDelay: 1 }}
                            className="text-9xl mb-6"
                        >
                            {animal.emoji}
                        </motion.div>
                        
                        <p className="text-2xl md:text-3xl text-gray-600 mb-6">
                            {animal.name}{getJosa(animal.name, 'ì´/ê°€')} ì •ë§ ë§›ìˆê²Œ ë¨¹ì—ˆì–´ìš”!<br/>
                            ê±°ìŠ¤ë¦„ëˆë„ ì •í™•í•˜ê²Œ ê³„ì‚°í–ˆì–´ìš”! ğŸ’¯
                        </p>
                        
                        {orders && orders.length > 1 && (
                            <div className="bg-purple-50 border-4 border-purple-300 rounded-2xl p-4 mb-6">
                                <div className="text-lg font-bold text-purple-700 mb-2">ì™„ì„±í•œ ìš”ë¦¬</div>
                                <div className="flex justify-center gap-4">
                                    {orders.map((order, i) => (
                                        <div key={i} className="text-center">
                                            <div className="text-4xl">{order.emoji}</div>
                                            <div className="text-sm font-bold">{order.name}</div>
                                            <div className="text-xs text-purple-600">{order.price}ì›</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                        
                        <div className="bg-gradient-to-r from-yellow-200 to-orange-200 rounded-2xl p-6 mb-8">
                            <div className="text-xl font-bold text-gray-700 mb-2">ì´ë²ˆì— ë²ˆ ëˆ</div>
                            <div className="text-5xl font-bold text-orange-600">ğŸ’° {totalEarned}ì›</div>
                        </div>
                        
                        <div className="bg-gradient-to-r from-green-200 to-blue-200 rounded-2xl p-6 mb-8">
                            <div className="text-xl font-bold text-gray-700 mb-2">ì´ ìˆ˜ìµ</div>
                            <div className="text-5xl font-bold text-green-600">ğŸ’µ {score}ì›</div>
                        </div>
                        
                        <motion.button
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            onClick={onNextRound}
                            className="bg-gradient-to-r from-purple-400 to-pink-400 text-white text-2xl md:text-3xl font-bold px-12 py-6 rounded-full cute-shadow"
                        >
                            ğŸ® ë‹¤ìŒ ì†ë‹˜ ë§ì´í•˜ê¸°!
                        </motion.button>
                    </div>
                </motion.div>
            );
        }

        // í”¼ë“œë°± ë©”ì‹œì§€
        function FeedbackMessage({ message }) {
            return (
                <motion.div
                    initial={{ y: -100, opacity: 0 }}
                    animate={{ y: 0, opacity: 1 }}
                    exit={{ y: -100, opacity: 0 }}
                    className="fixed top-24 left-1/2 transform -translate-x-1/2 z-50"
                >
                    <div className="bg-orange-500 text-white text-xl md:text-2xl font-bold px-8 py-4 rounded-full cute-shadow">
                        {message}
                    </div>
                </motion.div>
            );
        }

        // ì•± ë Œë”ë§
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RestaurantGame />);
    </script>
</body>
</html>